"use script";(function(){function require(module){if(module in app.modules){let am=app.modules[module];return typeof am=="function"&&(am=am(),app.modules[module]=am),am}throw new Error('module "'+module+'" not found');}function component(name){if(name in app.components)return app.components[name];throw new Error('component "'+name+'" not found');}window.app={modules:{},components:{}};window.require=require;window.component=component;let rootElem=document.querySelector("meta[name=rootUrl]");window.$$rootUrl=rootElem?rootElem.content||"":""})(),function(elem){elem.closest=elem.closest||function(css){let node=this;while(node){if(node.matches(css))return node;node=node.parentElement}return null}}(Element.prototype);app.modules["std:utils"]=function(){function isFunction(value){return typeof value=="function"}function isDefined(value){return typeof value!="undefined"}function isObject(value){return value!==null&&typeof value=="object"}function isDate(value){return value instanceof Date}function isString(value){return typeof value=="string"}function isNumber(value){return typeof value=="number"}function isBoolean(value){return typeof value=="boolean"}function isObjectExact(value){return isObject(value)&&!Array.isArray(value)}function isPrimitiveCtor(ctor){return ctor===String||ctor===Number||ctor===Boolean||ctor===Date}function isDateCtor(ctor){return ctor===Date}function isEmptyObject(obj){return!obj||Object.keys(obj).length===0&&obj.constructor===Object}function notBlank(val){if(!val)return!1;if(isDate(val))return!dateIsZero(val);switch(typeof val){case"string":return val!=="";case"date":return!1;case"object":if("$id"in val)return!!val.$id}return(val||"")!==""}function toJson(data){return JSON.stringify(data,function(key,value){return key[0]==="$"||key[0]==="_"?undefined:value},2)}function toString(obj){if(isDefined(obj)){if(obj===null)return"";if(isObject(obj))return toJson(obj)}else return"";return obj+""}function defaultValue(type){switch(type){case Number:return 0;case String:return"";case Boolean:return!1;case Date:return dateZero();default:throw new Error(`There is no default value for type ${type}`);}}function eval(obj,path,dataType,hideZeros){if(!path)return"";let ps=(path||"").split("."),r=obj;for(let i=0;i<ps.length;i++){let pi=ps[i];if(!(pi in r))throw new Error(`Property '${pi}' not found in ${r.constructor.name} object`);r=r[ps[i]]}return isDate(r)?format(r,dataType,hideZeros):isObject(r)?toJson(r):format?format(r,dataType,hideZeros):r}function pad2(num){return num<10?"0"+num:""+num}function parse(obj,dataType){switch(dataType){case"Currency":case"Number":return toNumber(obj);case"Date":return dateParse(obj)}return obj}function format(obj,dataType,hideZeros){if(!dataType)return obj;if(!isDefined(obj))return"";switch(dataType){case"DateTime":return isDate(obj)?dateIsZero(obj)?"":formatDate(obj)+" "+formatTime(obj):(console.error(`Invalid Date for utils.format (${obj})`),obj);case"Date":return isDate(obj)?dateIsZero(obj)?"":formatDate(obj):(console.error(`Invalid Date for utils.format (${obj})`),obj);case"DateUrl":return dateIsZero(obj)?"":""+obj.getFullYear()+pad2(obj.getMonth()+1)+pad2(obj.getDate());case"Time":return isDate(obj)?dateIsZero(obj)?"":formatTime(obj):(console.error(`Invalid Date for utils.format (${obj})`),obj);case"Currency":return isNumber(obj)?hideZeros&&obj===0?"":currencyFormat(obj):(console.error(`Invalid Currency for utils.format (${obj})`),obj);case"Number":return isNumber(obj)?hideZeros&&obj===0?"":numberFormat(obj):(console.error(`Invalid Number for utils.format (${obj})`),obj);default:console.error(`Invalid DataType for utils.format (${dataType})`)}return obj}function getStringId(obj){return obj?isNumber(obj)?obj:isObjectExact(obj)?obj.$id||0:"0":"0"}function toNumber(val){return isString(val)&&(val=val.replace(/\s/g,"").replace(",",".")),isFinite(val)?+val:0}function dateToday(){let td=new Date;return td.setHours(0,-td.getTimezoneOffset(),0,0),td}function dateZero(){let td=new Date(0,0,1);return td.setHours(0,-td.getTimezoneOffset(),0,0),td}function dateParse(str){if(str=str||"",!str)return dateZero();let today=dateToday(),seg=str.split(".");seg.length==1?(seg.push(""+(today.getMonth()+1)),seg.push(""+today.getFullYear())):seg.length==2&&seg.push(""+today.getFullYear());let td=new Date(+seg[2],+seg[1]-1,+seg[0],0,0,0,0);return isNaN(td.getDate())?dateZero():(td.setHours(0,-td.getTimezoneOffset(),0,0),td)}function dateEqual(d1,d2){return d1.getFullYear()===d2.getFullYear()&&d1.getMonth()===d2.getMonth()&&d1.getDate()===d2.getDate()}function dateIsZero(d1){return dateEqual(d1,dateZero())}function textContains(text,probe){return probe?text?(text||"").toString().toLowerCase().indexOf(probe.toLowerCase())!=-1:!1:!0}function textContainsText(obj,props,probe){if(!probe)return!0;if(!obj)return!1;for(v of props.split(","))if(textContains(obj[v],probe))return!0;return!1}function defProperty(trg,prop,get){Object.defineProperty(trg,prop,{enumerable:!0,configurable:!0,get:get})}function debounce(fn,timeout){let timerId=null;return function(){clearTimeout(timerId);timerId=setTimeout(()=>{fn.call()},timeout)}}const dateLocale="uk-UA",_2digit="2-digit",dateOptsDate={timeZone:"UTC",year:"numeric",month:_2digit,day:_2digit},dateOptsTime={timeZone:"UTC",hour:_2digit,minute:_2digit},formatDate=new Intl.DateTimeFormat(dateLocale,dateOptsDate).format,formatTime=new Intl.DateTimeFormat(dateLocale,dateOptsTime).format,currencyFormat=new Intl.NumberFormat(undefined,{minimumFractionDigits:2,useGrouping:!0}).format,numberFormat=new Intl.NumberFormat(undefined,{minimumFractionDigits:0,useGrouping:!0}).format;return{isArray:Array.isArray,isFunction:isFunction,isDefined:isDefined,isObject:isObject,isObjectExact:isObjectExact,isDate:isDate,isString:isString,isNumber:isNumber,isBoolean:isBoolean,toString:toString,defaultValue:defaultValue,notBlank:notBlank,toJson:toJson,isPrimitiveCtor:isPrimitiveCtor,isDateCtor:isDateCtor,isEmptyObject:isEmptyObject,defineProperty:defProperty,eval:eval,format:format,toNumber:toNumber,parse:parse,getStringId:getStringId,date:{today:dateToday,zero:dateZero,parse:dateParse,equal:dateEqual,isZero:dateIsZero,formatDate:formatDate},text:{contains:textContains,containsText:textContainsText},debounce:debounce}};app.modules["std:url"]=function(){function normalize(elem){return elem=""+elem||"",elem=elem.replace(/\\/g,"/"),elem.startsWith("/")&&(elem=elem.substring(1)),elem.endsWith("/")&&(elem=elem.substring(0,elem.length-1)),elem}function normalizeRoot(path){let root=window.$$rootUrl;return root&&path.startsWith(root)?path.substring(root.length):path}function combine(...args){return"/"+args.map(normalize).filter(x=>!!x).join("/")}function toUrl(obj){return utils.isDefined(obj)?utils.isDate(obj)?utils.format(obj,"DateUrl"):utils.isObjectExact(obj)?""+obj.$id||"0":""+obj:""}function makeQueryString(obj){if(!obj||!utils.isObjectExact(obj))return"";let esc=encodeURIComponent,query=Object.keys(obj).filter(k=>k.startsWith("_")||k.startsWith("$")||!!obj[k]).map(k=>esc(k)+"="+esc(toUrl(obj[k]))).join("&");return query?"?"+query:""}function parseQueryString(str){var obj={};return str.replace(/\??([^=&]+)=([^&]*)/g,function(m,key,value){obj[decodeURIComponent(key)]=""+decodeURIComponent(value)}),obj}function idChangedOnly(newUrl,oldUrl){let ns=(newUrl||"").split("/"),os=(oldUrl||"").split("/");return ns.length!==os.length?!1:os[os.length-1]==="new"&&ns[ns.length-1]!=="new"&&ns.slice(0,ns.length-1).join("/")===os.slice(0,os.length-1).join("/")?!0:!1}function makeBaseUrl(url){let x=(url||"").split("/");return x.length===6?x.slice(2,4).join("/"):url}function parseUrlAndQuery(url,querySrc){let query={};for(let p in querySrc)query[p]=toUrl(querySrc[p]);let rv={url:url,query:query};if(url.indexOf("?")!==-1){let a=url.split("?");rv.url=a[0];rv.query=Object.assign({},parseQueryString(a[1]),query)}return rv}function replaceUrlQuery(url,query){url||(url=window.location.pathname+window.location.search);let pu=parseUrlAndQuery(url,query);return pu.url+makeQueryString(pu.query)}function createUrlForNavigate(url,data){let urlId=data||"new",qs="";return utils.isDefined(urlId.$id)?urlId=urlId.$id:utils.isObjectExact(urlId)&&(urlId=data.Id,delete data.Id,qs=makeQueryString(data)),combine(url,urlId)+qs}const utils=require("std:utils");return{combine,makeQueryString,parseQueryString,normalizeRoot,idChangedOnly,makeBaseUrl,parseUrlAndQuery,replaceUrlQuery,createUrlForNavigate,firstUrl:""}},function(){function set(target,prop,value){Vue.set(target,prop,value)}function defer(func){Vue.nextTick(func)}app.modules["std:platform"]={set:set,defer:defer};app.modules["std:eventBus"]=new Vue({})}();app.modules["std:http"]=function(){function doRequest(method,url,data){return new Promise(function(resolve,reject){let xhr=new XMLHttpRequest;xhr.onload=function(){if(eventBus.$emit("endRequest",url),xhr.status===200){let ct=xhr.getResponseHeader("content-type"),xhrResult=xhr.responseText;ct.indexOf("application/json")!==-1&&(xhrResult=JSON.parse(xhr.responseText));resolve(xhrResult)}else xhr.status===255?reject(xhr.responseText||xhr.statusText):reject(xhr.statusText)};xhr.onerror=function(){eventBus.$emit("endRequest",url);reject(xhr.statusText)};xhr.open(method,url,!0);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("Accept","application/json, text/html");eventBus.$emit("beginRequest",url);xhr.send(data)})}function get(url){return doRequest("GET",url)}function post(url,data){return doRequest("POST",url,data)}function upload(url,data){return new Promise(function(resolve){let xhr=new XMLHttpRequest;xhr.onload=function(){if(xhr.status===200){let xhrResult=JSON.parse(xhr.responseText);resolve(xhrResult)}else xhr.status===255&&alert(xhr.responseText||xhr.statusText)};xhr.onerror=function(){alert("Error")};xhr.open("POST",url,!0);xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.setRequestHeader("Accept","application/json");xhr.send(data)})}function load(url,selector){let fc=selector?selector.firstElementChild:null;return fc&&fc.__vue__&&fc.__vue__.$destroy(),new Promise(function(resolve){doRequest("GET",url).then(function(html){let dp=new DOMParser,rdoc=dp.parseFromString(html,"text/html"),srcElem=rdoc.body.firstElementChild,elemId=srcElem.id||null;if(selector.innerHTML=srcElem?srcElem.outerHTML:"",elemId&&!document.getElementById(elemId)){selector.innerHTML="";resolve(!1);return}for(let i=0;i<rdoc.scripts.length;i++){let s=rdoc.scripts[i];if(s.type==="text/javascript"){let newScript=document.createElement("script");newScript.text=s.text;document.body.appendChild(newScript).parentNode.removeChild(newScript)}}if(selector.firstElementChild&&selector.firstElementChild.__vue__){let ve=selector.firstElementChild.__vue__;ve.$data.__baseUrl__=urlTools.normalizeRoot(url);ve.$data.__baseQuery__=urlTools.parseUrlAndQuery(url).query}resolve(!0)}).catch(function(error){alert(error);resolve(!1)})})}const eventBus=require("std:eventBus"),urlTools=require("std:url");return{get:get,post:post,load:load,upload:upload}},function(){function setTitle(to){to.title&&(document.title=to.title,titleStore[to.url]=to.title)}function makeBackUrl(url){let urlArr=url.split("/");return urlArr.length===5?urlArr.slice(0,3).join("/"):url.length===4?urlArr.slice(0,2).join("/"):url}function normalizedRoute(){let path=window.location.pathname;return urlTools.normalizeRoot(path)}function replaceUrlSearch(url,search){let parts=url.split("?");return parts[0]+(search||"")}function replaceUrlQuery(url,query){return replaceUrlSearch(url,urlTools.makeQueryString(query))}const eventBus=require("std:eventBus"),urlTools=require("std:url"),titleStore={};const store=new Vuex.Store({strict:!0,state:{route:normalizedRoute(),query:urlTools.parseQueryString(window.location.search)},getters:{seg0:state=>state.route.split("/")[1],seg1:state=>state.route.split("/")[2],len:state=>state.route.split("/").length,url:state=>state.route,query:state=>state.query,route:state=>{let sr=state.route.split("/");return{len:sr.length,seg0:sr[1],seg1:sr[2]}},baseUrl:state=>state.route+urlTools.makeQueryString(state.query),search:state=>urlTools.makeQueryString(state.query)},mutations:{navigate:function(state,to){let root=window.$$rootUrl,oldUrl=root+state.route+urlTools.makeQueryString(state.query);state.route=to.url;state.query=Object.assign({},to.query);let newUrl=root+state.route+urlTools.makeQueryString(to.query),h=window.history;setTitle(to);h.replaceState(oldUrl,null,oldUrl);h.pushState(oldUrl,null,newUrl)},query:function(state,query){let root=window.$$rootUrl;state.query=Object.assign({},query);let newUrl=root+state.route+urlTools.makeQueryString(state.query);window.history.replaceState(null,null,newUrl)},setquery:function(state,query){let root=window.$$rootUrl,oldUrl=root+this.getters.baseUrl;state.query=Object.assign({},state.query,query);let newUrl=root+this.getters.baseUrl;newUrl!==oldUrl&&(window.history.replaceState(null,null,newUrl),eventBus.$emit("queryChange",urlTools.makeQueryString(state.query)))},popstate:function(state){state.route=normalizedRoute();state.query=urlTools.parseQueryString(window.location.search);state.route in titleStore&&(document.title=titleStore[state.route])},setstate:function(state,to){window.history.replaceState(null,null,window.$$rootUrl+to.url);state.route=normalizedRoute();state.query=urlTools.parseQueryString(window.location.search);setTitle(to)},setnewid:function(state,to){let root=window.$$rootUrl,oldRoute=state.route,newRoute=oldRoute.replace("/new","/"+to.id);state.route=newRoute;let newUrl=root+newRoute+urlTools.makeQueryString(state.query);window.history.replaceState(null,null,newUrl)},close:function(state){function navigateBack(){let url=makeBackUrl(state.route);if(url===state.route){let firstUrl=urlTools.firstUrl;store.commit("navigate",{url:firstUrl.url,title:firstUrl.title})}else store.commit("navigate",{url:url})}if(window.history.length>1){let oldUrl=window.location.pathname;window.history.back();setTimeout(()=>{window.location.pathname===oldUrl&&navigateBack()},300)}else navigateBack()}}});store.parseQueryString=urlTools.parseQueryString;store.makeQueryString=urlTools.makeQueryString;store.replaceUrlSearch=replaceUrlSearch;store.replaceUrlQuery=replaceUrlQuery;store.makeBackUrl=makeBackUrl;app.components["std:store"]=store}();app.modules["std:log"]=function(){function info(msg){_traceEnabled&&console.info(msg)}function warning(msg){_traceEnabled&&console.warn(msg)}function error(msg){console.error(msg)}function countTime(msg,start,enable){(_traceEnabled||enable)&&console.warn(msg+" "+(performance.now()-start).toFixed(2)+" ms")}function loadSession(){let te=window.sessionStorage.getItem(traceEnabledKey);te!==null&&(_traceEnabled=te==="true",_traceEnabled&&console.warn("tracing is enabled"));_sessionLoaded=!0}let _traceEnabled=!1,_sessionLoaded=!1;const traceEnabledKey="traceEnabled";return{info:info,warn:warning,error:error,time:countTime,traceEnabled:function(){return _sessionLoaded||loadSession(),_traceEnabled},enableTrace:function(val){_traceEnabled=val;console.warn("tracing is "+(_traceEnabled?"enabled":"disabled"));window.sessionStorage.setItem(traceEnabledKey,val)}}};app.modules["std:validators"]=function(){function validateStd(rule,val){switch(rule){case"notBlank":return utils.notBlank(val);case"email":return validEmail(val);case"url":return validUrl(val);case"isTrue":return val===!0}return console.error(`invalid std rule: '${rule}'`),!0}function validateImpl(rules,item,val,ff){let retval=[];return rules.forEach(function(rule){const sev=rule.severity||ERROR;if(!utils.isFunction(rule.applyIf)||rule.applyIf(item,val))if(utils.isString(rule))validateStd("notBlank",val)||retval.push({msg:rule,severity:ERROR});else if(utils.isString(rule.valid))validateStd(rule.valid,val)||retval.push({msg:rule.msg,severity:sev});else if(utils.isFunction(rule.valid)){let vr=rule.valid(item,val);vr&&vr.then?vr.then(result=>{let dm={severity:sev,msg:rule.msg},nu=!1;utils.isString(result)?(dm.msg=result,retval.push(dm),nu=!0):result||(retval.push(dm),nu=!0);item._root_._needValidate_=!0;nu&&ff&&ff()}):utils.isString(vr)?retval.push({msg:vr,severity:sev}):vr||retval.push({msg:rule.msg,severity:sev})}else console.error("invalid valid element type for rule")}),retval}function validateItem(rules,item,val,du){let arr=[];utils.isArray(rules)?arr=rules:utils.isObject(rules)?arr.push(rules):utils.isString(rules)&&arr.push({valid:"notBlank",msg:rules});return validateImpl(arr,item,val,du)}function validEmail(addr){return addr===""||EMAIL_REGEXP.test(addr)}function validUrl(url){return url===""||URL_REGEXP.test(url)}const utils=require("std:utils"),ERROR="error",EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i;return{validate:validateItem}}