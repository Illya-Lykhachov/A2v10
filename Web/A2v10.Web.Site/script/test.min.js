"use strict";function _toConsumableArray(n){if(Array.isArray(n)){for(var t=0,i=Array(n.length);t<n.length;t++)i[t]=n[t];return i}return Array.from(n)}function _taggedTemplateLiteral(n,t){return Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}var _templateObject=_taggedTemplateLiteral(["There is no method 'exec' in command '","'"],["There is no method 'exec' in command '","'"]);(function(){function t(n){if(n in app.modules){var t=app.modules[n];return typeof t=="function"&&(t=t(),app.modules[n]=t),t}throw new Error('module "'+n+'" not found');}function i(n){if(n in app.components)return app.components[n];throw new Error('component "'+n+'" not found');}window.app={modules:{},components:{}};window.require=t;window.component=i;var n=document.querySelector("meta[name=rootUrl]");window.$$rootUrl=n?n.content||"":""})(),function(n){n.closest=n.closest||function(n){for(var t=this;t;){if(t.matches(n))return t;t=t.parentElement}return null}}(Element.prototype);app.modules["std:utils"]=function(){function nt(n){return typeof n=="function"}function o(n){return typeof n!="undefined"}function r(n){return n!==null&&typeof n=="object"}function n(n){return n instanceof Date}function c(n){return typeof n=="string"}function u(n){return typeof n=="number"}function tt(n){return typeof n=="boolean"}function l(n){return r(n)&&!Array.isArray(n)}function it(n){return n===String||n===Number||n===Boolean||n===Date}function rt(n){return n===Date}function ut(n){return!n||Object.keys(n).length===0&&n.constructor===Object}function ft(i){if(!i)return!1;if(n(i))return!t(i);switch(typeof i){case"string":return i!=="";case"date":return!1;case"object":if("$id"in i)return!!i.$id}return(i||"")!==""}function s(n){return JSON.stringify(n,function(n,t){return n[0]==="$"||n[0]==="_"?undefined:t},2)}function et(n){if(o(n)){if(n===null)return"";if(r(n))return s(n)}else return"";return n+""}function ot(n){switch(n){case Number:return 0;case String:return"";case Boolean:return!1;case Date:return i();default:throw new Error("There is no default value for type "+n);}}function st(t,i,u,e){var c,o,h,l;if(!i)return"";for(c=(i||"").split("."),o=t,h=0;h<c.length;h++){if(l=c[h],!(l in o))throw new Error("Property '"+l+"' not found in "+o.constructor.name+" object");o=o[c[h]]}return n(o)?f(o,u,e):r(o)?s(o):f?f(o,u,e):o}function a(n){return n<10?"0"+n:""+n}function ht(n,t){switch(t){case"Currency":case"Number":return y(n);case"Date":return w(n)}return n}function f(i,r,f){if(!r)return i;if(!o(i))return"";switch(r){case"DateTime":return n(i)?t(i)?"":h(i)+" "+g(i):(console.error("Invalid Date for utils.format ("+i+")"),i);case"Date":return n(i)?t(i)?"":h(i):(console.error("Invalid Date for utils.format ("+i+")"),i);case"DateUrl":return t(i)?"":""+i.getFullYear()+a(i.getMonth()+1)+a(i.getDate());case"Time":return n(i)?t(i)?"":g(i):(console.error("Invalid Date for utils.format ("+i+")"),i);case"Currency":return u(i)?f&&i===0?"":wt(i):(console.error("Invalid Currency for utils.format ("+i+")"),i);case"Number":return u(i)?f&&i===0?"":bt(i):(console.error("Invalid Number for utils.format ("+i+")"),i);default:console.error("Invalid DataType for utils.format ("+r+")")}return i}function ct(n){return n?u(n)?n:l(n)?n.$id||0:"0":"0"}function y(n){return c(n)&&(n=n.replace(/\s/g,"").replace(",",".")),isFinite(n)?+n:0}function p(){var n=new Date;return n.setHours(0,-n.getTimezoneOffset(),0,0),n}function i(){var n=new Date(0,0,1);return n.setHours(0,-n.getTimezoneOffset(),0,0),n}function w(n){var u,t,r;return(n=n||"",!n)?i():(u=p(),t=n.split("."),t.length==1?(t.push(""+(u.getMonth()+1)),t.push(""+u.getFullYear())):t.length==2&&t.push(""+u.getFullYear()),r=new Date(+t[2],+t[1]-1,+t[0],0,0,0,0),isNaN(r.getDate()))?i():(r.setHours(0,-r.getTimezoneOffset(),0,0),r)}function b(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()}function t(n){return b(n,i())}function k(n,t){return t?n?(n||"").toString().toLowerCase().indexOf(t.toLowerCase())!=-1:!1:!0}function lt(n,t,i){var r,f;if(!i)return!0;if(!n)return!1;var u=!0,e=!1,o=undefined;try{for(r=t.split(",")[Symbol.iterator]();!(u=(f=r.next()).done);u=!0)if(v=f.value,k(n[v],i))return!0}catch(s){e=!0;o=s}finally{try{!u&&r["return"]&&r["return"]()}finally{if(e)throw o;}}return!1}function at(n,t,i){Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:i})}function vt(n,t){var i=null;return function(){clearTimeout(i);i=setTimeout(function(){n.call()},t)}}var d="uk-UA",e="2-digit",yt={timeZone:"UTC",year:"numeric",month:e,day:e},pt={timeZone:"UTC",hour:e,minute:e},h=new Intl.DateTimeFormat(d,yt).format,g=new Intl.DateTimeFormat(d,pt).format,wt=new Intl.NumberFormat(undefined,{minimumFractionDigits:2,useGrouping:!0}).format,bt=new Intl.NumberFormat(undefined,{minimumFractionDigits:0,useGrouping:!0}).format;return{isArray:Array.isArray,isFunction:nt,isDefined:o,isObject:r,isObjectExact:l,isDate:n,isString:c,isNumber:u,isBoolean:tt,toString:et,defaultValue:ot,notBlank:ft,toJson:s,isPrimitiveCtor:it,isDateCtor:rt,isEmptyObject:ut,defineProperty:at,eval:st,format:f,toNumber:y,parse:ht,getStringId:ct,date:{today:p,zero:i,parse:w,equal:b,isZero:t,formatDate:h},text:{contains:k,containsText:lt},debounce:vt}};app.modules["std:url"]=function(){function e(n){return n=""+n||"",n=n.replace(/\\/g,"/"),n.startsWith("/")&&(n=n.substring(1)),n.endsWith("/")&&(n=n.substring(0,n.length-1)),n}function o(n){var t=window.$$rootUrl;return t&&n.startsWith(t)?n.substring(t.length):n}function i(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return"/"+i.map(e).filter(function(n){return!!n}).join("/")}function r(t){return n.isDefined(t)?n.isDate(t)?n.format(t,"DateUrl"):n.isObjectExact(t)?""+t.$id||"0":""+t:""}function t(t){if(!t||!n.isObjectExact(t))return"";var i=encodeURIComponent,u=Object.keys(t).filter(function(n){return!n.startsWith("_")&&!n.startsWith("$")&&!!t[n]}).map(function(n){return i(n)+"="+i(r(t[n]))}).join("&");return u?"?"+u:""}function u(n){var t={};return n.replace(/\??([^=&]+)=([^&]*)/g,function(n,i,r){t[decodeURIComponent(i)]=""+decodeURIComponent(r)}),t}function s(n,t){var i=(n||"").split("/"),r=(t||"").split("/");return i.length!==r.length?!1:r[r.length-1]==="new"&&i[i.length-1]!=="new"&&i.slice(0,i.length-1).join("/")===r.slice(0,r.length-1).join("/")?!0:!1}function h(n){var t=(n||"").split("/");return t.length===6?t.slice(2,4).join("/"):n}function f(n,t){var f={},e,i,o;for(e in t)f[e]=r(t[e]);return i={url:n,query:f},n.indexOf("?")!==-1&&(o=n.split("?"),i.url=o[0],i.query=Object.assign({},u(o[1]),f)),i}function c(n,i){n||(n=window.location.pathname+window.location.search);var r=f(n,i);return r.url+t(r.query)}function l(r,u){var f=u||"new",e="";return n.isDefined(f.$id)?f=f.$id:n.isObjectExact(f)&&(f=u.Id,delete u.Id,e=t(u)),i(r,f)+e}var n=require("std:utils");return{combine:i,makeQueryString:t,parseQueryString:u,normalizeRoot:o,idChangedOnly:s,makeBaseUrl:h,parseUrlAndQuery:f,replaceUrlQuery:c,createUrlForNavigate:l,firstUrl:""}},function(){function n(n,t,i){Vue.set(n,t,i)}function t(n){Vue.nextTick(n)}app.modules["std:platform"]={set:n,defer:t};app.modules["std:eventBus"]=new Vue({})}();app.modules["std:http"]=function(){function n(n,i,r){return new Promise(function(u,f){var e=new XMLHttpRequest;e.onload=function(){if(t.$emit("endRequest",i),e.status===200){var r=e.getResponseHeader("content-type"),n=e.responseText;r.indexOf("application/json")!==-1&&(n=JSON.parse(e.responseText));u(n)}else e.status===255?f(e.responseText||e.statusText):f(e.statusText)};e.onerror=function(){t.$emit("endRequest",i);f(e.statusText)};e.open(n,i,!0);e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("Accept","application/json, text/html");t.$emit("beginRequest",i);e.send(r)})}function r(t){return n("GET",t)}function u(t,i){return n("POST",t,i)}function f(n,t){return new Promise(function(i){var r=new XMLHttpRequest;r.onload=function(){if(r.status===200){var n=JSON.parse(r.responseText);i(n)}else r.status===255&&alert(r.responseText||r.statusText)};r.onerror=function(){alert("Error")};r.open("POST",n,!0);r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.setRequestHeader("Accept","application/json");r.send(t)})}function e(t,r){var u=r?r.firstElementChild:null;return u&&u.__vue__&&u.__vue__.$destroy(),new Promise(function(u){n("GET",t).then(function(n){var a=new DOMParser,o=a.parseFromString(n,"text/html"),s=o.body.firstElementChild,l=s.id||null,f,h,e,c;if(r.innerHTML=s?s.outerHTML:"",l&&!document.getElementById(l)){r.innerHTML="";u(!1);return}for(f=0;f<o.scripts.length;f++)h=o.scripts[f],h.type==="text/javascript"&&(e=document.createElement("script"),e.text=h.text,document.body.appendChild(e).parentNode.removeChild(e));r.firstElementChild&&r.firstElementChild.__vue__&&(c=r.firstElementChild.__vue__,c.$data.__baseUrl__=i.normalizeRoot(t),c.$data.__baseQuery__=i.parseUrlAndQuery(t).query);u(!0)})["catch"](function(n){alert(n);u(!1)})})}var t=require("std:eventBus"),i=require("std:url");return{get:r,post:u,load:e,upload:f}},function(){function u(n){n.title&&(document.title=n.title,r[n.url]=n.title)}function e(n){var t=n.split("/");return t.length===5?t.slice(0,3).join("/"):n.length===4?t.slice(0,2).join("/"):n}function i(){var t=window.location.pathname;return n.normalizeRoot(t)}function f(n,t){var i=n.split("?");return i[0]+(t||"")}function o(t,i){return f(t,n.makeQueryString(i))}var s=require("std:eventBus"),n=require("std:url"),r={},t=new Vuex.Store({strict:!0,state:{route:i(),query:n.parseQueryString(window.location.search)},getters:{seg0:function(n){return n.route.split("/")[1]},seg1:function(n){return n.route.split("/")[2]},len:function(n){return n.route.split("/").length},url:function(n){return n.route},query:function(n){return n.query},route:function(n){var t=n.route.split("/");return{len:t.length,seg0:t[1],seg1:t[2]}},baseUrl:function(t){return t.route+n.makeQueryString(t.query)},search:function(t){return n.makeQueryString(t.query)}},mutations:{navigate:function(t,i){var e=window.$$rootUrl,r=e+t.route+n.makeQueryString(t.query),o,f;t.route=i.url;t.query=Object.assign({},i.query);o=e+t.route+n.makeQueryString(i.query);f=window.history;u(i);f.replaceState(r,null,r);f.pushState(r,null,o)},query:function(t,i){var u=window.$$rootUrl,r;t.query=Object.assign({},i);r=u+t.route+n.makeQueryString(t.query);window.history.replaceState(null,null,r)},setquery:function(n,t){var r=window.$$rootUrl,u=r+this.getters.baseUrl,i;(n.query=Object.assign({},n.query,t),i=r+this.getters.baseUrl,i!==u)&&(window.history.replaceState(null,null,i),s.$emit("queryChange",n.query))},popstate:function(t){t.route=i();t.query=n.parseQueryString(window.location.search);t.route in r&&(document.title=r[t.route])},setstate:function(t,r){window.history.replaceState(null,null,window.$$rootUrl+r.url);t.route=i();t.query=n.parseQueryString(window.location.search);u(r)},setnewid:function(t,i){var f=window.$$rootUrl,e=t.route,r=e.replace("/new","/"+i.id),u;t.route=r;u=f+r+n.makeQueryString(t.query);window.history.replaceState(null,null,u)},close:function(){function n(){window.close()}window.history.length>1?function(){var t=window.location.pathname;window.history.back();setTimeout(function(){window.location.pathname===t&&n()},300)}():n()}}});t.parseQueryString=n.parseQueryString;t.makeQueryString=n.makeQueryString;t.replaceUrlSearch=f;t.replaceUrlQuery=o;t.makeBackUrl=e;app.components["std:store"]=t}();app.modules["std:log"]=function(){function r(t){n&&console.info(t)}function u(t){n&&console.warn(t)}function f(n){console.error(n)}function e(t,i,r){(n||r)&&console.warn(t+" "+(performance.now()-i).toFixed(2)+" ms")}function o(){var r=window.sessionStorage.getItem(i);r!==null&&(n=r==="true",n&&console.warn("tracing is enabled"));t=!0}var n=!1,t=!1,i="traceEnabled";return{info:r,warn:u,error:f,time:e,traceEnabled:function(){return t||o(),n},enableTrace:function(t){n=t;console.warn("tracing is "+(n?"enabled":"disabled"));window.sessionStorage.setItem(i,t)}}};app.modules["std:validators"]=function(){function t(t,i){switch(t){case"notBlank":return n.notBlank(i);case"email":return f(i);case"url":return e(i);case"isTrue":return i===!0}return console.error("invalid std rule: '"+t+"'"),!0}function r(r,u,f,e){var o=[];return r.forEach(function(r){var h=r.severity||i,s;(!n.isFunction(r.applyIf)||r.applyIf(u,f))&&(n.isString(r)?t("notBlank",f)||o.push({msg:r,severity:i}):n.isString(r.valid)?t(r.valid,f)||o.push({msg:r.msg,severity:h}):n.isFunction(r.valid)?(s=r.valid(u,f),s&&s.then?s.then(function(t){var i={severity:h,msg:r.msg},f=!1;n.isString(t)?(i.msg=t,o.push(i),f=!0):t||(o.push(i),f=!0);u._root_._needValidate_=!0;f&&e&&e()}):n.isString(s)?o.push({msg:s,severity:h}):s||o.push({msg:r.msg,severity:h})):console.error("invalid valid element type for rule"))}),o}function u(t,i,u,f){var e=[];return n.isArray(t)?e=t:n.isObject(t)?e.push(t):n.isString(t)&&e.push({valid:"notBlank",msg:t}),r(e,i,u,f)}function f(n){return n===""||o.test(n)}function e(n){return n===""||s.test(n)}var n=require("std:utils"),i="error",o=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+\/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,s=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+\])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i;return{validate:u}},function(){function t(n,t,i,r){Object.defineProperty(n,t,{writable:r||!1,enumerable:!1,configurable:!1,value:i})}function i(n,t,i){Object.defineProperty(n,t,{enumerable:!1,configurable:!1,get:i})}function r(n,t,i){Object.defineProperty(n,t,{enumerable:!0,configurable:!0,get:i})}function g(t,i){return(n.isDefined(i)||(i=n.defaultValue(t)),t===Number)?n.toNumber(i):i}function nt(t,i,r){var e=t._meta_.props[r],h=t._path_?t._path_+".":"",u=t._src_,f,o;i=i||{};switch(e){case Number:u[r]=i[r]||0;break;case String:u[r]=i[r]||"";break;case Boolean:u[r]=i[r]||!1;break;case Date:f=i[r]||null;u[r]=f?new Date(f):n.date.zero();break;case s:o=t._meta_.markerProps[r];u[r]=o;break;default:u[r]=new e(i[r]||null,h+r,t)}Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:function(){return this._src_[r]},set:function(n){if((n=g(this._meta_.props[r],n),n!==this._src_[r])&&(this._src_[r]&&this._src_[r].$set?this._src_[r].$merge(n,!1):this._src_[r]=n,this._root_.$setDirty(!0),!this._lockEvents_)&&this._path_){var t=this._path_+"."+r+".change";this._root_.$emit(t,this,n)}}})}function s(){}function tt(t,i){var h=t._root_.$template,o,f,r,e;if(h&&(o=h._props_,o)&&(f=i.name,f in o))for(r in o[f])e=o[f][r],n.isPrimitiveCtor(e)?(u.info("create scalar property: "+f+"."+r),t._meta_.props[r]=e):n.isObjectExact(e)&&(e.get||(u.info("create object property: "+f+"."+r),t._meta_.props[r]=s,t._meta_.markerProps||(t._meta_.markerProps={}),t._meta_.markerProps[r]=e))}function h(t,i){var s=t._root_.$template,o,f,e,r;if(s&&(o=s._props_,o)&&(f=i.name,f in o))for(e in o[f])if(r=o[f][e],n.isPrimitiveCtor(r))continue;else n.isFunction(r)?(u.info("create property: "+f+"."+e),Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})):n.isObjectExact(r)?r.get&&(u.info("create property: "+f+"."+e),Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r.get,set:r.set})):alert("todo: invalid property type")}function it(f,e,o,s){var g=f.constructor.name,l=null,c,a,it,ut,v,y,d,ft;g==="TRoot"&&(l=performance.now());s=s||f;t(f,ii,{});t(f,w,o);t(f,b,s._root_||s);t(f,p,s);t(f,ri,null,!0);t(f,"_lockEvents_",0,!0);c=!1;a=f._root_.$template;a&&!n.isEmptyObject(a._props_)&&(c=!0);c&&tt(f,f.constructor);for(it in f._meta_.props)nt(f,e,it,s);if(c&&h(f,f.constructor),o&&o.endsWith("]")&&(f.$selected=!1),r(f,"$valid",function(){var t,i,r;if(this._root_._needValidate_&&this._root_._validateAll_(),this._errors_)return!1;for(t in this)if(t[0]!=="$"&&t[0]!=="_"&&(i=this[t],n.isObject(i)&&"$valid"in i&&(r=this[t],!r.$valid)))return!1;return!0}),r(f,"$invalid",function(){return!this.$valid}),f._meta_.$group===!0&&r(f,"$groupName",function(){var i,t;return n.isDefined(this.$level)?(i=this._root_.__modelInfo.Levels,i&&(t=i[this.constructor.name],t&&this.$level<=t.length))?this[t[this.$level-1]]:(console.error("invalid data for $groupName"),k):k}),ut=g+".construct",v=null,f._root_.$emit(ut,f),f._root_===f){f._root_ctor_=f.constructor;f.$dirty=!1;f._query_={};for(y in f._meta_.props)d=y+".$RowCount",e&&d in e&&(ft=e[d]||0,f[y].$RowCount=ft);f._enableValidate_=!0;f._needValidate_=!1;f._modelLoad_=function(n){v=n;f._fireLoad_();ui=!0};f._fireLoad_=function(){f.$emit("Model.load",f,v);f._root_.$setDirty(!1)};i(f,"$readOnly",rt)}return l&&u.time("create root time:",l,!1),f}function rt(){if("__modelInfo"in this){var t=this.__modelInfo;if(n.isDefined(t.ReadOnly))return t.ReadOnly}return!1}function ut(n,i,u,f,e){var o=new ft(n?n.length:0),l=i+"[]",c,s;if(t(o,"_elem_",u),t(o,w,i),t(o,p,e),t(o,b,e._root_||e),r(o,"$valid",function(){var n,i,r;if(this._errors_)return!1;var t=!0,u=!1,f=undefined;try{for(n=this[Symbol.iterator]();!(t=(i=n.next()).done);t=!0)if(r=i.value,r._errors_)return!1}catch(e){u=!0;f=e}finally{try{!t&&n["return"]&&n["return"]()}finally{if(u)throw f;}}return!0}),r(o,"$invalid",function(){return!this.$valid}),h(o,f),c=f.name+".construct",o._root_.$emit(c,o),!n)return o;for(s=0;s<n.length;s++)o[s]=new o._elem_(n[s],l,o),o[s].$checked=!1;return o}function ft(n){var t=new Array(n||0);return et(t),t}function et(t){c(t);t.$new=function(n){var t=new this._elem_(n||null,this._path_+"[]",this);return t.$checked=!1,t};r(t,"$selected",function(){var t=!0,r=!1,u=undefined,n,f,i;try{for(n=this.$elements[Symbol.iterator]();!(t=(f=n.next()).done);t=!0)if(i=f.value,i.$selected)return i}catch(e){r=!0;u=e}finally{try{!t&&n["return"]&&n["return"]()}finally{if(r)throw u;}}return undefined});r(t,"$elements",function(){function n(i){var r,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<i.length)){t.next=10;break}return u=i[r],t.next=5,u;case 5:if(!u.$items){t.next=7;break}return t.delegateYield(n(u.$items),"t0",7);case 7:r++;t.next=1;break;case 10:case"end":return t.stop()}},t[0],this)}var t=[n].map(regeneratorRuntime.mark);return n(this)});r(t,"Count",function(){return this.length});r(t,"$isEmpty",function(){return!this.length});r(t,"$checked",function(){return this.filter(function(n){return n.$checked})});t.Selected=function(n){var t=this.$selected;return t?t[n]:null};t.$loadLazy=function(){var n=this;return new Promise(function(t){var i,r,u;if(n.$loaded){t(self);return}if(!n.$parent){t(n);return}if(i=n.$parent._meta_,!i.$lazy){t(n);return}if(r=n._path_.lastIndexOf("."),u=n._path_.substring(r+1),!1){t(n);return}n.$vm.$loadLazy(n.$parent,u).then(function(){return t(n)})})};t.$append=function(t){function u(n,t){var h=i._path_+"[].adding",r=i.$new(n),c=i._root_.$emit(h,i,r),f,u,o,s;if(c!==!1)return f=i.push(r),u=i[f-1],"$RowCount"in i&&(i.$RowCount+=1),o=i._path_+"[].add",i._root_.$setDirty(!0),i._root_.$emit(o,i,u,f-1),t&&(u.$select(),e(i,u)),"$rowNo"in r._meta_&&(s=r._meta_.$rowNo,r[s]=f),u}var i=this,r;if(n.isArray(t)){if(r=function(){var i=[],n=null;return t.forEach(function(t){n=u(t,!1);i.push(n)}),n&&n.$select(),{v:i}}(),typeof r=="object")return r.v}else return u(t,!0)};t.$empty=function(){if(!this.$root.isReadOnly)return this.splice(0,this.length),"$RowCount"in this&&(this.$RowCount=0),this};t.$clearSelected=function(){var n=this.$selected;n&&(n.$selected=!1,e(this,null))};t.$remove=function(n){var t,r,u,i;if(!this.$root.isReadOnly&&n&&(t=this.indexOf(n),t!==-1)&&(this.splice(t,1),"$RowCount"in this&&(this.$RowCount-=1),r=this._path_+"[].remove",this._root_.$setDirty(!0),this._root_.$emit(r,this,n,t),this.length)&&(t>=this.length&&(t-=1),this.length>t&&this[t].$select(),"$rowNo"in n._meta_))for(u=n._meta_.$rowNo,i=0;i<this.length;i++)this[i][u]=i+1};t.$copy=function(t){if(!this.$root.isReadOnly){if(this.$empty(),n.isArray(t))for(var i=0;i<t.length;i++)this.push(this.$new(t[i]));return this}}}function c(n){i(n,"$host",function(){return this._root_._host_});i(n,"$root",function(){return this._root_});i(n,"$parent",function(){return this._parent_});i(n,"$vm",function(){return this._root_&&this._root_._host_?this._root_._host_.$viewModel:null})}function ot(n,r,u){t(n.prototype,ti,r);n.prototype.$merge=v;n.prototype.$empty=kt;n.prototype.$set=dt;c(n.prototype);i(n.prototype,"$isNew",function(){return!this.$id});i(n.prototype,"$isEmpty",function(){return!this.$id});i(n.prototype,"$id",function(){var n=this._meta_.$id,t;if(!n){t=this.constructor.name;throw new Error(t+" object does not have an Id property");}return this[n]});i(n.prototype,"$name",function(){var n=this._meta_.$name,t;if(!n){t=this.constructor.name;throw new Error(t+" object does not have a Name property");}return this[n]});u&&st(n);r.$hasChildren&&i(n.prototype,"$hasChildren",function(){var n=this._meta_.$hasChildren;return n?this[n]:undefined});r.$items&&i(n.prototype,"$items",function(){var n=this._meta_.$items;return n?this[n]:undefined})}function e(n,t){var i=n._path_+"[].select",r=n._root_.$emit(i,n,t)}function st(n){n.prototype.$remove=function(){var n=this._parent_;n.$remove(this)};n.prototype.$select=function(n){var i=n||this._parent_,t=i.$selected;t!==this&&(t&&(t.$selected=!1),this.$selected=!0,e(i,this))}}function ht(n){var r,t,f,e;if((this._enableValidate_&&(this._needValidate_||(this._needValidate_=!0)),u.info("emit: "+n),r=this.$template,r)&&(t=r.events,t)&&n in t){u.info("handle: "+n);f=t[n];for(var o=arguments.length,s=Array(o>1?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return e=f.call.apply(f,[undefined].concat(s)),e===!1&&u.info(n+" returns false"),e}}function ct(n){var t=this.$template;if(!t.delegates)return console.error("There are no delegates in the template"),null;if(n in t.delegates)return t.delegates[n];console.error('Delegate "'+n+'" not found in the template')}function lt(t,i,r){var f=this.$template,u,e,o;return f?f.commands?(u=f.commands[t],!u)?!1:(e=r&&r.validRequired===!0,o=r&&r.checkReadOnly===!0,(u.checkReadOnly===!0||o)&&this.$root.$readOnly)?!1:(u.validRequired===!0||e)&&!this.$root.$valid?!1:n.isFunction(u.canExec)?u.canExec.call(this,i):n.isBoolean(u.canExec)?u.canExec:n.isDefined(u.canExec)?(console.error(t+".canExec should be a function"),!1):!0:!1:!1}function at(t,i,r,u){var f=this,e;try{if(e=function(){var o,s,e,h,c;if(f._root_._enableValidate_=!1,o=f.$vm,s=f.$template,!s)return{v:undefined};if(!s.commands)return{v:undefined};if(e=s.commands[t],!e)return console.error('Command "'+t+'" not found'),{v:undefined};var l=e.confirm||r,a=e.saveRequired||u&&u.saveRequired,v=e.validRequired||u&&u.validRequired;if(v&&!o.$data.$valid)return{v:undefined};if(n.isFunction(e.canExec)&&!e.canExec.call(f,i))return{v:undefined};h=f;c=function(){var r=function(){n.isFunction(e)?e.call(h,i):n.isFunction(e.exec)?e.exec.call(h,i):console.error($(_templateObject,t))};l?o.$confirm(l).then(r):r()};a&&o.$isDirty?o.$save().then(c):c()}(),typeof e=="object")return e.v}finally{this._root_._enableValidate_=!0;this._root_._needValidate_=!0}}function vt(n,t,i,r){var u,f,e;return n?(u=n._root_.$template,!u)?null:(f=u.validators,!f)?null:(e=f[t],!e)?null:d.validate(e,n,i,r):null}function l(t,i,r){if(t._errors_||r)!t._errors_&&r&&(t._errors_={});else return;return r&&r.length>0?t._errors_[i]=r:i in t._errors_&&delete t._errors_[i],n.isEmptyObject(t._errors_)&&(t._errors_=null),r}function yt(n,t,i,r){if(!n._root_._needValidate_)return n._errors_?t in n._errors_?n._errors_[t]:null:null;var u=vt(n,t,i,r);return l(n,t,u)}function f(n,t,i,r){var c,e,s,v,o,l,u,h,a,p;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(r=r||"",t){y.next=5;break}return y.next=4,{item:n,val:n[i],ix:r};case 4:return y.abrupt("return");case 5:c=t.split(".");e=n;s=0;case 8:if(!(s<c.length)){y.next=46;break}if(v=s===c.length-1,o=c[s],!o.endsWith("[]")){y.next=33;break}if(l=o.substring(0,o.length-2),l in e||console.error("Invalid validator key. Property '"+l+"' not found in '"+e.constructor.name+"'"),u=e[l],u){y.next=17;break}return y.abrupt("continue",43);case 17:h=0;case 18:if(!(h<u.length)){y.next=30;break}if(a=u[h],!v){y.next=25;break}return y.next=23,{item:a,val:a[i],ix:r+":"+h};case 23:y.next=27;break;case 25:return p=c.slice(s+1).join("."),y.delegateYield(f(a,p,i,r+":"+h),"t0",27);case 27:h++;y.next=18;break;case 30:return y.abrupt("return");case 33:if(o in e||console.error("Invalid Validator key. property '"+o+"' not found in '"+e.constructor.name+"'"),u=e[o],!v){y.next=42;break}if(!u){y.next=39;break}return y.next=39,{item:u,val:u[i],ix:r};case 39:return y.abrupt("return");case 42:e=u;case 43:s++;y.next=8;break;case 46:case"end":return y.stop()}},y[0],this)}function a(n,t){var i,r,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.lastIndexOf("."),r="",u=t,i!==-1&&(r=t.substring(0,i),u=t.substring(i+1)),e.delegateYield(f(n,r,u,""),"t0",5);case 5:case"end":return e.stop()}},y[1],this)}function pt(n,t,i){var u,s,f,r;if(i){var e=[],o=!0,h=!1,c=undefined;try{for(u=a(n,t)[Symbol.iterator]();!(o=(s=u.next()).done);o=!0)f=s.value,r=d.validate(i,f.item,f.val),l(f.item,t,r),r&&r.length&&e.push.apply(e,_toConsumableArray(r))}catch(v){h=!0;c=v}finally{try{!o&&u["return"]&&u["return"]()}finally{if(h)throw c;}}return e.length?e:null}}function wt(){var n=this,e,r,t,o,i,f,s;if(n._host_&&n._needValidate_&&(n._needValidate_=!1,e=performance.now(),r=n.$template,r)&&(t=r.validators,t)){o=[];for(i in t)f=pt(n,i,t[i]),f&&o.push({x:i,e:f});s=performance.now();u.time("validation time:",e)}}function bt(n){this.$root.$readOnly||(this.$dirty=n)}function kt(){this.$set({})}function dt(n){this.$root.isReadOnly||this.$merge(n,!0)}function v(t,i){var r,f,u,e,s,h;try{t===null&&(t={});this._root_._enableValidate_=!1;this._lockEvents_+=1;for(r in this._meta_.props)f=this._meta_.props[r],u=this[r],Array.isArray(u)?(u.$copy(t[r]),"$RowCount"in u&&(e=r+".$RowCount",u.$RowCount=e in t?t[e]||0:0)):n.isDateCtor(f)?o.set(this,r,new Date(t[r])):n.isPrimitiveCtor(f)?o.set(this,r,t[r]):(s=new f(t[r],r,this),o.set(this,r,s))}finally{this._root_._enableValidate_=!0;this._root_._needValidate_=!0;this._lockEvents_-=1}i&&(h=this._path_+".change",this._root_.$emit(h,this.$parent,this))}function gt(n,t){var i,r,u;if(n.prototype.$emit=ht,n.prototype.$setDirty=bt,n.prototype.$merge=v,n.prototype.$template=t,n.prototype._exec_=at,n.prototype._canExec_=lt,n.prototype._delegate_=ct,n.prototype._validate_=yt,n.prototype._validateAll_=wt,t){i={};for(r in t.properties){if(u=r.split("."),u.length!==2){console.error("invalid propery name '"+r+"'");continue}var f=u[0],e=u[1],o=t.properties[r];f in i||(i[f]={});i[f][e]=o}t._props_=i}}function ni(n,t){n.__modelInfo=t?t:{PageSize:20}}var y=[f,a].map(regeneratorRuntime.mark),ti="_meta_",p="_parent_",ii="_src_",w="_path_",b="_root_",ri="_errors_",k="#err#",o=require("std:platform"),d=require("std:validators"),n=require("std:utils"),u=require("std:log"),ui=!1;app.modules["std:datamodel"]={createObject:it,createArray:ut,defineObject:ot,implementRoot:gt,setModelInfo:ni,enumData:f}}(),function(){function t(t,i){return n.post(t,i)}function i(t){return n.get(t)}var n=require("std:http"),r=require("std:utils");app.modules["std:dataservice"]={post:t,get:i}}();app.modules["std:popup"]=function(){function f(t){n.push(t)}function e(t){var i=n.indexOf(t);i!==-1&&n.splice(i,1);delete t._close}function o(){r||(r=!0,document.body.addEventListener("click",i),document.body.addEventListener("contextmenu",i),document.body.addEventListener("keydown",c))}function t(n,t){return n?n.closest(t):null}function s(){n.forEach(function(n){n._close&&n._close(document)})}function h(n){var i,t,r;if(n)for(i=n.querySelectorAll(".popover-wrapper"),t=0;t<i.length;t++)r=i[t],r._close&&r._close()}function i(i){var r,f;if(n.length!==0)for(r=0;r<n.length;r++)if(f=n[r],t(i.target,".dropdown-item")||i.target.hasAttribute("close-dropdown")||t(i.target,"[dropdown-top]")!==f){if(!f._close)throw new Error(u);f._close(i.target)}}function c(t){var i,r;if(t.which===27)for(i=0;i<n.length;i++){if(r=n[i],!r._close)throw new Error(u);r._close(t.target)}}var n=[],r=!1,u="Perhaps you forgot to create a _close function for popup element";return{startService:o,registerPopup:f,unregisterPopup:e,closeAll:s,closest:t,closeInside:h}},function(){var n=require("std:http"),t=require("std:url");Vue.component("include",{template:'<div :class="implClass"><\/div>',props:{src:String,cssClass:String,needReload:Boolean},data:function(){return{loading:!0,currentUrl:"",_needReload:!0}},methods:{loaded:function(){this.loading=!1},requery:function(){this.currentUrl&&(this.__destroy(),n.load(this.currentUrl,this.$el).then(this.loaded))},__destroy:function(){var t=this.$el.firstElementChild,n;t&&(n=t.__vue__,n&&!n.$marker&&(n=n.$parent),n&&n.$marker()&&n.$destroy())}},computed:{implClass:function(){return"include "+(this.cssClass||"")+" "+(this.loading?"loading":"")}},mounted:function(){this.src&&(this.currentUrl=this.src,n.load(this.src,this.$el).then(this.loaded))},destroyed:function(){this.__destroy()},watch:{src:function(i,r){i.split("?")[0]===r.split("?")[0]?this.currentUrl=i:t.idChangedOnly(i,r)?this.currentUrl=i:(this.loading=!0,this.currentUrl=i,this.__destroy(),n.load(i,this.$el).then(this.loaded))},needReload:function(n){n&&this.requery()}}})}(),function(){var n=require("std:utils"),t={props:{label:String,required:Boolean,align:{type:String,"default":"left"},description:String,disabled:Boolean,tabIndex:Number,dataType:String,validatorOptions:Object},computed:{path:function(){return this.item._path_+"."+this.prop},pathToValidate:function(){return this.itemToValidate._path_+"."+this.propToValidate},modelValue:function(){var t=this.item[this.prop];return this.dataType?n.format(t,this.dataType):t},errors:function(){var n,t;return this.item?(n=this.item._root_,!n)?null:n._validate_?(t=undefined,this.itemToValidate?n._validate_(this.itemToValidate,this.pathToValidate,this.itemToValidate[this.propToValidate],this.deferUpdate):n._validate_(this.item,this.path,this.modelValue,this.deferUpdate)):null:null},inputClass:function(){var n="";return this.align!=="left"&&(n+="text-"+this.align),this.isNegative&&(n+=" negative-red"),n},isNegative:function(){return(this.dataType==="Number"||this.dataType==="Currency")&&this.item&&this.modelValue<0?!0:!1},hasLabel:function(){return!!this.label},hasDescr:function(){return!!this.description}},methods:{valid:function(){return!this.invalid()},invalid:function(){var n=this.errors;return n?n.length>0:!1},cssClass:function(){var n="control-group"+(this.invalid()?" invalid":" valid");return this.required&&(n+=" required"),this.disabled&&(n+=" disabled"),n},deferUpdate:function(){this.$children.forEach(function(n){return n.$forceUpdate()});this.$forceUpdate()},test:function(){alert("from base control")}}};app.components.control=t}();Vue.component("validator",{props:{invalid:Function,errors:Array,options:Object},template:'<div v-if="invalid()" class="validator" :class="cssClass" :style="cssStyle"><span v-for="err in errors" v-text="err.msg" :class="err.severity"><\/span><\/div>',computed:{cssStyle:function(){var n={};return this.options&&this.options.width&&(n.width=this.options.width),n},cssClass:function(){var n={};return this.options&&this.options.placement&&(n[this.options.placement]=!0),n}}}),function(){var t=require("std:utils"),n=component("control");Vue.component("textbox",{"extends":n,template:'<div :class="cssClass()">\n\t<label v-if="hasLabel" v-text="label" />\n\t<div class="input-group">\n\t\t<input ref="input" :type="controlType" v-focus \n\t\t\tv-bind:value="modelValue" v-on:change="updateValue($event.target.value)" :class="inputClass" :placeholder="placeholder" :disabled="disabled" :tabindex="tabIndex"/>\n\t\t<slot><\/slot>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"><\/validator>\n\t<\/div>\n\t<span class="descr" v-if="hasDescr" v-text="description"><\/span>\n<\/div>\n',props:{item:{type:Object,"default":function(){return{}}},prop:String,itemToValidate:Object,propToValidate:String,placeholder:String,password:Boolean},computed:{controlType:function(){return this.password?"password":"text"}},methods:{updateValue:function(n){this.item[this.prop]=t.parse(n,this.dataType);this.$refs.input.value!==this.modelValue&&(this.$refs.input.value=this.modelValue,this.$emit("change",this.item[this.prop]))}}});Vue.component("a2-textarea",{"extends":n,template:'<div :class="cssClass()">\n\t<label v-if="hasLabel" v-text="label" />\n\t<div class="input-group">\n\t\t<textarea v-focus v-auto-size="autoSize" v-model.lazy="item[prop]" :rows="rows" :class="inputClass" :placeholder="placeholder" :disabled="disabled" :tabindex="tabIndex"/>\n\t\t<slot><\/slot>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"><\/validator>\n\t<\/div>\n\t<span class="descr" v-if="hasDescr" v-text="description"><\/span>\n<\/div>\n',props:{item:{type:Object,"default":function(){return{}}},prop:String,itemToValidate:Object,propToValidate:String,placeholder:String,autoSize:Boolean,rows:Number}});Vue.component("static",{"extends":n,template:'<div :class="cssClass()">\n\t<label v-if="hasLabel" v-text="label" />\n\t<div class="input-group static">\n\t\t<span v-focus v-text="text" :class="inputClass" :tabindex="tabIndex"/>\n\t\t<slot><\/slot>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"><\/validator>\n\t<\/div>\n\t<span class="descr" v-if="hasDescr" v-text="description"><\/span>\n<\/div>\n',props:{item:{type:Object,"default":function(){return{}}},prop:String,itemToValidate:Object,propToValidate:String,text:[String,Number,Date]}})}(),function(){var n=require("std:utils"),t=component("control"),i={_validate_:function(){return!0}};Vue.component("combobox",{"extends":t,template:'<div :class="cssClass()">\n\t<label v-if="hasLabel" v-text="label" />\n\t<div class="input-group">\n\t\t<select v-focus v-model="cmbValue" :class="inputClass" :disabled="disabled" :tabindex="tabIndex">\n\t\t\t<slot>\n\t\t\t\t<option v-for="(cmb, cmbIndex) in itemsSource" :key="cmbIndex" \n\t\t\t\t\tv-text="cmb.$name" :value="cmb"><\/option>\n\t\t\t<\/slot>\n\t\t<\/select>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"><\/validator>\n\t<\/div>\n\t<span class="descr" v-if="hasDescr" v-text="description"><\/span>\n<\/div>\n',props:{prop:String,item:{type:Object,"default":function(){return{}}},itemsSource:{type:Array,"default":function(){return[]}},itemToValidate:Object,propToValidate:String},computed:{cmbValue:{get:function(){var t=this.item?this.item[this.prop]:null;return n.isObjectExact(t)?"$id"in t?this.itemsSource.indexOf(t)!==-1?t:this.itemsSource.find(function(n){return n.$id===t.$id}):t:t},set:function(n){this.item&&(this.item[this.prop]=n)}}}})}(),function(){var t=require("std:popup"),n=require("std:utils"),i=require("std:eventBus"),r=component("control");Vue.component("a2-date-picker",{"extends":r,template:'\n<div :class="cssClass2()">\n\t<label v-if="hasLabel" v-text="label" />\n    <div class="input-group">\n        <input v-focus v-model.lazy="model" :class="inputClass" :disabled="disabled" />\n        <a href @click.stop.prevent="toggle($event)"><i class="ico ico-calendar"><\/i><\/a>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"><\/validator>\n\t\t<div class="calendar" v-if="isOpen" @click.stop.prevent="dummy">\n\t\t\t<table>\n\t\t\t\t<thead><tr>\n\t\t\t\t\t\t<th><a @click.stop.prevent=\'prevMonth\'><i class="ico ico-triangle-left"><\/i><\/a><\/th>\n\t\t\t\t\t\t<th colspan="5"><span v-text="title"><\/span><\/th>\n\t\t\t\t\t\t<th><a @click.stop.prevent=\'nextMonth\'><i class="ico ico-triangle-right"><\/i><\/a><\/th>\t\t\t\t\t\n\t\t\t\t\t<\/tr>\n\t\t\t\t\t<tr class="weekdays"><th v-for="d in 7" v-text="wdTitle(d)">Пн<\/th><\/tr>\n\t\t\t\t<\/thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr v-for="row in days">\n\t\t\t\t\t\t<td v-for="day in row" :class="dayClass(day)"><a @click.stop.prevent="selectDay(day)" v-text="day.getDate()" :title="dayTitle(day)"/><\/td>\n\t\t\t\t\t<\/tr>\n\t\t\t\t<\/tbody>\n\t\t\t\t<tfoot><tr><td colspan="7"><a @click.stop.prevent=\'today\'>cегодня<\/a><\/td><\/tr><\/tfoot>\n\t\t\t<\/table>\n\t\t<\/div>\n    <\/div>\n\t<span class="descr" v-if="hasDescr" v-text="description"><\/span>\n<\/div>\n',props:{item:Object,prop:String,itemToValidate:Object,propToValidate:String,align:{type:String,"default":"center"}},data:function(){return{isOpen:!1}},methods:{dummy:function(){},toggle:function(){this.isOpen||(i.$emit("closeAllPopups"),n.date.isZero(this.modelDate)&&(this.item[this.prop]=n.date.today()));this.isOpen=!this.isOpen},today:function(){this.selectDay(n.date.today())},prevMonth:function(){var n=new Date(this.modelDate);n.setMonth(n.getMonth()-1);this.item[this.prop]=n},nextMonth:function(){var n=new Date(this.modelDate);n.setMonth(n.getMonth()+1);this.item[this.prop]=n},selectDay:function(n){this.item[this.prop]=n;this.isOpen=!1},wdTitle:function(n){var t=this.days[0][n-1];return t.toLocaleString("uk-UA",{weekday:"short"})},dayClass:function(t){var i="",r=n.date;return r.equal(t,r.today())&&(i+=" today"),r.equal(t,this.modelDate)&&(i+=" active"),t.getMonth()!==this.modelDate.getMonth()&&(i+=" other"),i},dayTitle:function(n){return n.toLocaleString("uk-UA",{year:"numeric",month:"long",day:"numeric",weekday:"long"})},cssClass2:function(){var n=this.cssClass();return this.isOpen&&(n+=" open"),n},__clickOutside:function(){this.isOpen=!1}},computed:{modelDate:function(){return this.item[this.prop]},model:{get:function(){return n.date.isZero(this.modelDate)?"":this.modelDate.toLocaleString("uk-UA",{year:"numeric",month:"2-digit",day:"2-digit"})},set:function(t){var i=n.date.parse(t);this.item[this.prop]=i;n.date.isZero(i)&&(this.isOpen=!1)}},title:function(){var n=this.modelDate.toLocaleString("uk-UA",{month:"long",year:"numeric"});return n.charAt(0).toUpperCase()+n.slice(1)},days:function(){var n=new Date(this.modelDate),e,t,i,r,u,f;for(n.setHours(0,-n.getTimezoneOffset(),0,0),e=n.getDate(),n.setDate(1),t=n.getDay()-1,t===-1?t=6:t===0&&(t=7),n.setDate(-t+1),i=[],r=0;r<6;r++){for(u=[],f=0;f<7;f++)u.push(new Date(n)),n.setDate(n.getDate()+1);i.push(u)}return i}},mounted:function(){t.registerPopup(this.$el);this.$el._close=this.__clickOutside},beforeDestroy:function(){t.unregisterPopup(this.$el)}})}(),function(){var n=require("std:popup"),t=require("std:utils"),u=require("std:platform"),i=component("control"),r=300;Vue.component("a2-selector",{"extends":i,template:'\n<div :class="cssClass2()">\n\t<label v-if="hasLabel" v-text="label" />\n\t<div class="input-group">\n\t\t<input v-focus v-model="query" :class="inputClass" :placeholder="placeholder"\n\t\t\t@input="debouncedUpdate"\n\t\t\t@blur.stop="cancel"\n\t\t\t@keydown.stop="keyUp"\n\t\t\t:disabled="disabled" />\n\t\t<slot><\/slot>\n\t\t<validator :invalid="invalid" :errors="errors" :options="validatorOptions"><\/validator>\n\t\t<div class="selector-pane" v-if="isOpen" ref="pane" :style="paneStyle">\n\t\t\t<slot name=\'pane\' :items="items" :is-item-active="isItemActive" :item-name="itemName" :hit="hit">\n\t\t\t\t<ul class="selector-pane" :style="listStyle">\n\t\t\t\t\t<li @mousedown.prevent="hit(itm)" :class="{active: isItemActive(itmIndex)}"\n\t\t\t\t\t\tv-for="(itm, itmIndex) in items" :key="itmIndex" v-text="itemName(itm)">}<\/li>\n\t\t\t\t<\/ul>\n\t\t\t\t<a class="create-elem a2-hyperlink a2-inline"><i class="ico ico-plus"/> новый элемент<\/a>\n\t\t\t<\/slot>\n\t\t<\/div>\n\t<\/div>\n\t<span class="descr" v-if="hasDescr" v-text="description"><\/span>\n<\/div>\n',props:{item:Object,prop:String,display:String,itemToValidate:Object,propToValidate:String,placeholder:String,delay:Number,minChars:Number,fetch:Function,listWidth:String,listHeight:String},data:function(){return{isOpen:!1,loading:!1,items:[],query:"",filter:"",current:-1}},computed:{$displayProp:function(){return this.display},valueText:function(){return this.item?this.item[this.prop][this.$displayProp]:""},pane:function(){return{items:this.items,isItemActive:this.isItemActive,itemName:this.itemName,hit:this.hit}},paneStyle:function(){return this.listWidth?{width:this.listWidth,minWidth:this.listWidth}:null},listStyle:function(){return this.listHeight?{maxHeight:this.listHeight}:null},debouncedUpdate:function(){var n=this,i=this.delay||r;return t.debounce(function(){n.current=-1;n.filter=n.query;n.update()},i)}},watch:{valueText:function(){this.query=this.valueText}},methods:{__clickOutside:function(){this.isOpen=!1},cssClass2:function(){var n=this.cssClass();return this.isOpen&&(n+=" open"),n},isItemActive:function(n){return n===this.current},itemName:function(n){return n[this.$displayProp]},cancel:function(){this.query=this.valueText;this.isOpen=!1},keyUp:function(n){if(this.isOpen)switch(n.which){case 27:this.cancel();break;case 13:if(this.current===-1)return;this.hit(this.items[this.current]);break;case 40:n.preventDefault();this.current+=1;this.current>=this.items.length&&(this.current=0);this.scrollIntoView();break;case 38:n.preventDefault();this.current-=1;this.current<0&&(this.current=this.items.length-1);this.scrollIntoView();break;default:return}},hit:function(n){Vue.set(this.item,this.prop,n);this.query=this.valueText;this.isOpen=!1},scrollIntoView:function(){var n=this;this.$nextTick(function(){var u=n.$refs.pane,t;if(u&&(t=u.querySelector(".active"),t)){var i=t.parentElement,r=t.offsetTop,f=r+t.offsetHeight,e=i.scrollTop,o=e+i.clientHeight;r<e&&(i.scrollTop=r);f>o&&(i.scrollTop=f-i.clientHeight)}})},update:function(){var n=this,t=this.query||"",i=+(this.minChars||0);i&&t.length<i||(this.isOpen=!0,this.loading=!0,this.fetchData(t).then(function(t){n.loading=!1;var i=Object.keys(t)[0];n.items=t[i]}))},fetchData:function(n){var t=this.item[this.prop];return this.fetch.call(t,t,n)}},mounted:function(){n.registerPopup(this.$el);this.query=this.valueText;this.$el._close=this.__clickOutside},beforeDestroy:function(){n.unregisterPopup(this.$el)}})}(),function(){var n=require("std:utils"),t=require("std:log"),i={name:"data-grid-column",template:'\n<th :class="cssClass" @click.prevent="doSort">\n    <div class="h-fill" v-if="fixedHeader">\n        {{headerText}}\n    <\/div><div class="h-holder">\n\t\t<slot>{{headerText}}<\/slot>\n\t<\/div>\n<\/th>\n',props:{header:String,content:String,dataType:String,hideZeros:Boolean,icon:String,bindIcon:String,id:String,align:{type:String,"default":"left"},editable:{type:Boolean,"default":!1},noPadding:{type:Boolean,"default":!1},validate:String,sort:{type:Boolean,"default":undefined},mark:String,controlType:String,width:String,fit:Boolean,wrap:String,command:Object},created:function(){this.$parent.$addColumn(this)},computed:{dir:function(){return this.$parent.sortDir(this.content)},fixedHeader:function(){return this.$parent.fixedHeader},isSortable:function(){return this.content?typeof this.sort=="undefined"?this.$parent.isGridSortable:this.sort:!1},isUpdateUrl:function(){return!this.$root.inDialog},template:function(){return this.id?this.$parent.$scopedSlots[this.id]:null},classAlign:function(){return this.align!=="left"?(" text-"+this.align).toLowerCase():""},cssClass:function(){var n=this.classAlign;return this.isSortable&&(n+=" sort",this.dir&&(n+=" "+this.dir)),n},headerText:function(){return this.header||" "}},methods:{doSort:function(){this.isSortable&&this.$parent.doSort(this.content)},cellCssClass:function(n,t){var i=this.classAlign,r;return this.mark&&(r=n[this.mark],r&&(i+=" "+r)),t&&this.controlType!=="checkbox"&&(i+=" cell-editable"),this.wrap&&(i+=" "+this.wrap),i.trim()}}};Vue.component("data-grid-column",i);var r={functional:!0,name:"data-grid-cell",props:{row:Object,col:Object,index:Number},render:function(t,i){function s(t,i){if(t=t||"",t==="this")t=u;else if(t.startsWith("{")){if(t=t.substring(1,t.length-1),!(t in u))throw new Error("Property '"+arg1+"' not found in "+u.constructor.name+" object");t=u[t]}else t&&i&&(console.error(r.hideZeros),t=n.eval(u,t,r.dataType,r.hideZeros));return t}function w(t){return(t.dataType==="Number"||t.dataType==="Currency")&&n.eval(u,t.content,t.dataType,t.hideZeros)<0?!0:!1}var e="td",u=i.props.row,r=i.props.col,b=i.props.index,f={"class":r.cellCssClass(u,r.editable||r.noPadding)},c={props:{row:u,col:r}},l,a,v,y,h;if(r.template)return l=r.template(c.props),t(e,f,[l]);if(r.controlType==="validator")return a={props:["item","col"],template:'<span><i v-if="item.$invalid" class="ico ico-error"><\/i><\/span>'},f["class"]={"cell-validator":!0},t(e,f,[t(a,{props:{item:u,col:r}})]);if(!r.content&&!r.icon&&!r.bindIcon)return t(e,f);if(v={props:["path","item"],template:'<validator :path="path" :item="item"><\/validator>'},y={props:{path:r.validate,item:u}},r.command&&(h=function(){var o=s(r.command.arg1,!1),i=s(r.command.arg2,r.command.eval),h=s(r.command.arg3,!1),a=r.command.$ev,l={props:["row","col"],template:'<a @click.prevent="doCommand($event)" :href="getHref()"><i v-if="hasIcon" :class="iconClass" class="ico"><\/i><span v-text="eval(row, col.content, col.dataType, col.hideZeros)"><\/span><\/a>',computed:{hasIcon:function(){return r.icon||r.bindIcon},iconClass:function(){return r.bindIcon?"ico-"+n.eval(u,r.bindIcon):r.icon?"ico-"+r.icon:null}},methods:{doCommand:function(n){n;r.command.cmd(o,i,h)},eval:n.eval,getHref:function(){if(r.command&&r.command.isDialog)return null;var t=i;return n.isObjectExact(i)&&(t=i.$id),o+"/"+t}}};return{v:t(e,f,[t(l,c)])}}(),typeof h=="object"))return h.v;if(r.content==="$index")return t(e,f,[b+1]);var k=n.eval(u,r.content,r.dataType,r.hideZeros),o=[t("span",{"class":{"negative-red":w(r)}},k)],p=r.content?"":" ico-single";return r.icon?o.unshift(t("i",{"class":"ico ico-"+r.icon+p})):r.bindIcon&&o.unshift(t("i",{"class":"ico ico-"+n.eval(u,r.bindIcon)+p})),r.validate&&o.push(t(v,y)),t(e,f,o)}},u={name:"data-grid-row",template:'\n<tr @click="rowSelect(row)" :class="rowClass()" v-on:dblclick.prevent="doDblClick">\n    <td v-if="isMarkCell" class="marker">\n        <div :class="markClass"><\/div>\n    <\/td>\n    <td v-if="detailsMarker" class="details-marker" @click.prevent="toggleDetails">\n        <i v-if="detailsIcon" class="ico" :class="detailsExpandClass" />\n    <\/td>\n\t<td class="group-marker" v-if="group"><\/td>\n    <data-grid-cell v-for="(col, colIndex) in cols" :key="colIndex" :row="row" :col="col" :index="index" />\n<\/tr>',components:{"data-grid-cell":r},props:{row:Object,cols:Array,index:Number,mark:String,group:Boolean,level:Number},computed:{isMarkCell:function(){return this.$parent.isMarkCell},detailsMarker:function(){return this.$parent.isRowDetailsCell},detailsIcon:function(){if(!this.detailsMarker)return!1;var n=this.$parent.rowDetailsVisible;return n===!1?!0:n&&this.row[n]},detailsExpandClass:function(){return this.row.$details?"ico-minus-circle":"ico-plus-circle"},totalColumns:function(){console.error("implement me")},markClass:function(){return this.mark?this.row[this.mark]:""}},methods:{rowClass:function(){var n="",t=this.row.$selected;return t&&(n+="active"),this.$parent.isMarkRow&&this.mark&&(n+=" "+this.row[this.mark]),(this.index+1)%2&&(n+=" even"),this.$parent.rowBold&&this.row[this.$parent.rowBold]&&(n+=" bold"),this.level&&(n+=" lev-"+this.level),n.trim()},rowSelect:function(n){n.$select()},doDblClick:function(n){(n.stopImmediatePropagation(),this.$parent.doubleclick)&&(window.getSelection().removeAllRanges(),this.$parent.doubleclick())},toggleDetails:function(){this.detailsIcon&&Vue.set(this.row,"$details",!this.row.$details)}}},f={name:"data-grid-row-details",template:'\n<tr v-if="visible()" class="row-details">\n    <td v-if="isMarkCell" class="marker">\n        <div :class="markClass"><\/div>\n    <\/td>\n    <td :colspan=\'totalCols\' class="details-cell">\n        <div class="details-wrapper"><slot><\/slot><\/div>\n    <\/td>\n<\/tr>\n',props:{cols:Number,row:Object,mark:String},computed:{isMarkCell:function(){return this.$parent.isMarkCell},markClass:function(){return this.mark?this.row[this.mark]:""},detailsMarker:function(){return this.$parent.isRowDetailsCell},totalCols:function(){return this.cols+(this.isMarkCell?1:0)+(this.detailsMarker?1:0)}},methods:{visible:function(){return this.$parent.isRowDetailsCell?this.row.$details?!0:!1:this.row==this.$parent.selected()}}};Vue.component("data-grid",{props:{"items-source":[Object,Array],border:Boolean,grid:String,striped:Boolean,fixedHeader:Boolean,hideHeader:Boolean,hover:{type:Boolean,"default":!1},compact:Boolean,sort:Boolean,routeQuery:Object,mark:String,filterFields:String,markStyle:String,rowBold:String,doubleclick:Function,groupBy:[Array,Object],rowDetails:Boolean,rowDetailsActivate:String,rowDetailsVisible:[String,Boolean]},template:'\n<div v-lazy="itemsSource" :class="{\'data-grid-container\':true, \'fixed-header\': fixedHeader, \'bordered\': border}">\n    <div :class="{\'data-grid-body\': true, \'fixed-header\': fixedHeader}">\n    <table :class="cssClass">\n        <colgroup>\n            <col v-if="isMarkCell" class="fit"/>\n\t\t\t<col v-if="isGrouping" class="fit"/>\n            <col v-if="isRowDetailsCell" class="fit" />\n            <col v-bind:class="columnClass(col)" v-bind:style="columnStyle(col)" v-for="(col, colIndex) in columns" :key="colIndex"><\/col>\n        <\/colgroup>\n        <thead>\n            <tr v-show="isHeaderVisible">\n                <th v-if="isMarkCell" class="marker"><div v-if="fixedHeader" class="h-holder">&#160;<\/div><\/th>\n                <th v-if="isRowDetailsCell" class="details-marker"><div v-if="fixedHeader" class="h-holder">&#160;<\/div><\/th>\n\t\t\t\t<th v-if="isGrouping" class="group-cell">\n\t\t\t\t\t<a @click.prevent="expandGroups(gi)" v-for="gi in $groupCount" v-text=\'gi\' /><a \n\t\t\t\t\t\t@click.prevent="expandGroups($groupCount + 1)" v-text=\'$groupCount + 1\' />\n\t\t\t\t<\/th>\n                <slot><\/slot>\n            <\/tr>\n        <\/thead>\n\t\t<template v-if="isGrouping">\n\t\t\t<tbody>\n\t\t\t\t<template v-for="(g, gIndex) of $groups">\n\t\t\t\t\t<tr v-if="isGroupGroupVisible(g)" :class="\'group lev-\' + g.level" :key="gIndex">\n\t\t\t\t\t\t<td @click.prevent=\'toggleGroup(g)\' :colspan="columns.length + 1">\n\t\t\t\t\t\t<span :class="{expmark: true, expanded: g.expanded}" />\n\t\t\t\t\t\t<span class="grtitle" v-text="groupTitle(g)" />\n\t\t\t\t\t\t<span v-if="g.source.count" class="grcount" v-text="g.count" /><\/td>\n\t\t\t\t\t<\/tr>\n\t\t\t\t\t<template v-for="(row, rowIndex) in g.items">\n\t\t\t\t\t\t<data-grid-row v-show="isGroupBodyVisible(g)" :group="true" :level="g.level" :cols="columns" :row="row" :key="gIndex + \':\' + rowIndex" :index="rowIndex" :mark="mark"><\/data-grid-row>\n                        <data-grid-row-details v-if="rowDetails" :cols="columns.length" :row="row" :key="\'rd:\' + gIndex + \':\' + rowIndex" :mark="mark">\n                            <slot name="row-details" :row="row"><\/slot>\n                        <\/data-grid-row-details>\n\t\t\t\t\t<\/template>\n\t\t\t\t<\/template>\n\t\t\t<\/tbody>\n\t\t<\/template>\n\t\t<template v-else>\n\t\t\t<tbody>\n                <template v-for="(item, rowIndex) in $items">\n\t\t\t\t    <data-grid-row :cols="columns" :row="item" :key="rowIndex" :index="rowIndex" :mark="mark" />\n                    <data-grid-row-details v-if="rowDetails" :cols="columns.length" :row="item" :key="\'rd:\' + rowIndex" :mark="mark">\n                        <slot name="row-details" :row="item"><\/slot>\n                    <\/data-grid-row-details>\n                <\/template>\n\t\t\t<\/tbody>\n\t\t<\/template>\n\t\t<slot name="footer"><\/slot>\n    <\/table>\n    <\/div>\n<\/div>\n',components:{"data-grid-row":u,"data-grid-row-details":f},data:function(){return{columns:[],clientItems:null,clientGroups:null,localSort:{dir:"asc",order:""}}},computed:{$items:function(){return this.clientItems?this.clientItems:this.itemsSource},isMarkCell:function(){return this.markStyle==="marker"||this.markStyle==="both"},isRowDetailsCell:function(){return this.rowDetails&&this.rowDetailsActivate=="cell"},isMarkRow:function(){return this.markStyle==="row"||this.markStyle==="both"},isHeaderVisible:function(){return!this.hideHeader},cssClass:function(){var n="data-grid";return this.grid&&(n+=" grid-"+this.grid.toLowerCase()),this.striped&&(n+=" striped"),this.hover&&(n+=" hover"),this.compact&&(n+=" compact"),n},isGridSortable:function(){return!!this.sort},isLocal:function(){return!this.$parent.sortDir},isGrouping:function(){return this.groupBy},$groupCount:function(){return n.isObjectExact(this.groupBy)?1:this.groupBy.length},$groups:function(){function h(n,t,i,r){var f,u,o,e,s;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:c.t0=regeneratorRuntime.keys(n);case 1:if((c.t1=c.t0()).done){c.next=17;break}if(f=c.t1.value,!(f==="items")){c.next=5;break}return c.abrupt("continue",1);case 5:return u=n[f],o=u.items?u.items.length:0,r&&(r.c+=o),e={group:f,p0:t,expanded:!0,level:i,items:u.items||null,count:o},c.next=11,e;case 11:if(n.items){c.next=15;break}return s={c:0},c.delegateYield(h(u,e,i+1,s),"t2",14);case 14:e.count+=s.c;case 15:c.next=1;break;case 17:case"end":return c.stop()}},et[0],this)}var et=[h].map(regeneratorRuntime.mark),e,y,o,p,w,i,s,b,u;this.doSortLocally();var ot=performance.now(),k={},f=this.groupBy;n.isObjectExact(f)&&(f=[f]);var c=!0,d=!1,g=undefined;try{for(e=this.$items[Symbol.iterator]();!(c=(y=e.next()).done);c=!0){var nt=y.value,r=k,l=!0,tt=!1,it=undefined;try{for(o=f[Symbol.iterator]();!(l=(p=o.next()).done);l=!0)w=p.value,i=nt[w.prop],n.isDefined(i)||(i=""),i===""&&(i="Unknown"),i in r||(r[i]={}),r=r[i]}catch(a){tt=!0;it=a}finally{try{!l&&o["return"]&&o["return"]()}finally{if(tt)throw it;}}r.items||(r.items=[]);r.items.push(nt)}}catch(a){d=!0;g=a}finally{try{!c&&e["return"]&&e["return"]()}finally{if(d)throw g;}}var rt=[],v=!0,ut=!1,ft=undefined;try{for(s=h(k,null,1)[Symbol.iterator]();!(v=(b=s.next()).done);v=!0)u=b.value,u.source=f[u.level-1],u.source.expanded===!1&&(u.expanded=!1),rt.push(u)}catch(a){ut=!0;ft=a}finally{try{!v&&s["return"]&&s["return"]()}finally{if(ut)throw ft;}}return this.clientGroups=rt,t.time("datagrid grouping time:",ot),this.clientGroups}},watch:{localSort:{handler:function(){this.handleSort()},deep:!0},"itemsSource.length":function(){this.handleSort()}},methods:{selected:function(){var n=this.itemsSource;return n.$origin&&(n=n.$origin),n.$selected},$addColumn:function(n){this.columns.push(n)},columnClass:function(t){var i="";return(t.fit||t.controlType==="validator")&&(i+="fit"),n.isDefined(t.dir)&&(i+=" sorted"),i},columnStyle:function(t){return{width:n.isDefined(t.width)?t.width:undefined}},doSort:function(n){this.isLocal?this.localSort.order===n?this.localSort.dir=this.localSort.dir==="asc"?"desc":"asc":this.localSort={order:n,dir:"asc"}:this.$parent.$emit("sort",n)},sortDir:function(n){return this.isLocal?this.localSort.order===n?this.localSort.dir:undefined:this.$parent.sortDir(n)},doSortLocally:function(){if(this.isLocal&&this.localSort.order){var u=performance.now(),n=this.localSort.dir==="desc",i=this.localSort.order,r=[].concat(this.itemsSource);r.sort(function(t,r){var u=t[i],f=r[i];return u===f?0:u<f?n?1:-1:n?-1:1});t.time("datagrid sorting time:",u);this.clientItems=r}},handleSort:function(){this.isGrouping?this.clientGroups=null:this.doSortLocally()},toggleGroup:function(n){n.expanded=!n.expanded},isGroupGroupVisible:function(n){if(!n.group)return!1;if(!n.p0)return!0;for(var t=n.p0;t;){if(!t.expanded)return!1;t=t.p0}return!0},isGroupBodyVisible:function(n){if(!n.expanded)return!1;for(var t=n.p0;t;){if(!t.expanded)return!1;t=t.p0}return!0},groupTitle:function(n){return n.source&&n.source.title?n.source.title.replace("{Value}",n.group).replace("{Count}",n.count):n.group},expandGroups:function(n){var i=!0,u=!1,f=undefined,t,e,r;try{for(t=this.$groups[Symbol.iterator]();!(i=(e=t.next()).done);i=!0)r=e.value,r.expanded=r.level<n}catch(o){u=!0;f=o}finally{try{!i&&t["return"]&&t["return"]()}finally{if(u)throw f;}}}}})}();Vue.component("a2-pager",{props:{source:Object},computed:{pages:function(){return Math.ceil(this.count/this.source.pageSize)},currentPage:function(){return Math.ceil(this.offset/this.source.pageSize)+1},title:function(){var n=Math.min(this.count,this.offset+this.source.pageSize);return this.count?"элементы: <b>"+(this.offset+1)+"<\/b>-<b>"+n+"<\/b> из <b>"+this.count+"<\/b>":"нет элементов"},offset:function(){return this.source.offset},count:function(){return this.source.sourceCount}},methods:{setOffset:function(n){this.offset!==n&&this.source.$setOffset(n)},isActive:function(n){return n===this.currentPage},click:function(n,t){t.preventDefault();switch(n){case"prev":this.setOffset(this.offset-this.source.pageSize);break;case"next":this.setOffset(this.offset+this.source.pageSize)}},goto:function(n,t){t.preventDefault();var i=(n-1)*this.source.pageSize;this.setOffset(i)}},render:function(n){var f=this,t=[],o={"class":"a2-pager-dots"},r=function(t){return n("button",{domProps:{innerText:t},on:{click:function(n){return f.goto(t,n)}},"class":{active:f.isActive(t)}})},i,u,e;for(t.push(n("button",{on:{click:function(n){return f.click("prev",n)}},attrs:{disabled:this.offset===0}},[n("i",{"class":"ico ico-chevron-left"})])),this.pages>0&&t.push(r(1)),this.pages>1&&t.push(r(2)),i=Math.max(this.currentPage-2,3),u=Math.min(i+5,this.pages-1),u-i<5&&(i=Math.max(u-5,3)),i>3&&t.push(n("span",o,"...")),e=i;e<u;++e)t.push(r(e));return u<this.pages-1&&t.push(n("span",o,"...")),this.pages>3&&t.push(r(this.pages-1)),this.pages>2&&t.push(r(this.pages)),t.push(n("button",{on:{click:function(n){return f.click("next",n)}},attrs:{disabled:this.currentPage>=this.pages}},[n("i",{"class":"ico ico-chevron-right"})])),t.push(n("span",{"class":"a2-pager-divider"})),t.push(n("span",{"class":"a2-pager-title",domProps:{innerHTML:this.title}})),n("div",{"class":"a2-pager"},t)}});Vue.component("popover",{template:'\n<div v-dropdown class="popover-wrapper">\n\t<span toggle class="popover-title"><i v-if="hasIcon" :class="iconClass"><\/i> <span :title="title" v-text="content"><\/span><\/span>\n\t<div class="popup-body">\n\t\t<div class="arrow" />\n\t\t<div v-if="visible">\n\t\t\t<include :src="popoverUrl"/>\n\t\t<\/div>\n\t\t<slot />\n\t<\/div>\t\n<\/div>\n',data:function(){return{state:"hidden",popoverUrl:""}},props:{icon:String,url:String,content:String,title:String},computed:{hasIcon:function(){return!!this.icon},iconClass:function(){var n="ico po-ico";return this.icon&&(n+=" ico-"+this.icon),n},visible:function(){return this.url&&this.state==="shown"}},mounted:function(){var n=this;this.$el._show=function(){n.state="shown";n.url&&(n.popoverUrl="/_popup"+n.url)};this.$el._hide=function(){n.state="hidden";n.popoverUrl=""}}}),function(){var n=require("std:utils"),t=require("std:eventBus"),i={name:"tree-item",template:'\n<li @click.stop.prevent="doClick(item)" :title="title"\n    :class="{expanded: isExpanded, collapsed:isCollapsed, active:isItemSelected}" >\n    <div :class="{overlay:true, \'no-icons\': !options.hasIcon}">\n        <a class="toggle" v-if="isFolder" href @click.stop.prevent="toggle"><\/a>\n        <span v-else class="toggle"/>\n        <i v-if="options.hasIcon" :class="iconClass"/>\n        <a v-if="hasLink(item)" :href="dataHref" tabindex="-1" v-text="item[options.label]" :class="{\'no-wrap\':!options.wrapLabel }"/>\n        <span v-else v-text="item[options.label]" :class="{\'tv-folder\':true, \'no-wrap\':!options.wrapLabel}"/>\n    <\/div>\n    <ul v-if="isFolder" v-show="isExpanded">\n        <tree-item v-for="(itm, index) in item[options.subitems]" :options="options"\n            :key="index" :item="itm" :click="click" :get-href="getHref" :is-active="isActive" :expand="expand" :root-items="rootItems"/>\n    <\/ul>   \n<\/li>\n',props:{item:Object,options:Object,rootItems:Array,click:Function,expand:Function,isActive:Function,getHref:Function},data:function(){return{open:!this.options.isDynamic}},methods:{isFolderSelect:function(t){var i=this.options.folderSelect;return n.isFunction(i)?i(t):!!this.options.folderSelect},doClick:function(n){t.$emit("closeAllPopups");this.isFolder&&!this.isFolderSelect(n)?this.toggle():this.options.isDynamic?n.$select(this.rootItems):this.click(n)},hasLink:function(n){return!this.isFolder||this.isFolderSelect(n)},toggle:function(){(t.$emit("closeAllPopups"),this.isFolder)&&(this.open=!this.open,this.options.isDynamic&&this.expand(this.item,this.options.subitems))},openElem:function(){this.isFolder&&(this.open=!0,this.isDynamic&&this.expand(this.item,this.options.subitems))}},computed:{isFolder:function(){if(this.options.isDynamic&&n.isDefined(this.item.$hasChildren)&&this.item.$hasChildren)return!0;var t=this.item[this.options.subitems];return t&&t.length},isExpanded:function(){return this.isFolder&&this.open},isCollapsed:function(){return this.isFolder&&!this.open},title:function(){var n=this.item[this.options.title];return n||(n=this.item[this.options.label]),n},isItemSelected:function(){return this.options.isDynamic?this.item.$selected:this.isActive?this.isActive&&this.isActive(this.item):!1},iconClass:function(){var n=this.options.staticIcons,t;return n?"ico ico-"+(this.isFolder?n[0]:n[1]):this.options.icon?(t=this.item[this.options.icon],t?"ico ico-"+(t||"empty"):""):undefined},dataHref:function(){return this.getHref?this.getHref(this.item):""}},watch:{isFolder:function(){}},updated:function(){if(this.options.isDynamic&&this.open&&this.item.$hasChildren){var n=this.item[this.options.subitems];n.$loaded||(this.open=!1)}}};Vue.component("tree-view",{components:{"tree-item":i},template:'\n<ul class="tree-view">\n    <tree-item v-for="(itm, index) in items" :options="options" :get-href="getHref"\n        :item="itm" :key="index"\n        :click="click" :is-active="isActive" :expand="expand" :root-items="items">\n    <\/tree-item>\n<\/ul>\n        ',props:{options:Object,items:Array,isActive:Function,click:Function,expand:Function,autoSelect:String,getHref:Function,expandFirstItem:Boolean},computed:{isSelectFirstItem:function(){return this.autoSelect==="first-item"}},watch:{items:function(){this.doExpandFirst()}},methods:{selectFirstItem:function(){var n,t;this.isSelectFirstItem&&(n=this.items,n.length)&&(t=n[0],t.$select&&t.$select(this.items))},doExpandFirst:function(){var n=this;this.expandFirstItem&&this.$nextTick(function(){n.$children&&n.$children.forEach(function(n){n&&n.openElem&&n.openElem()})})}},created:function(){this.selectFirstItem();this.doExpandFirst()},updated:function(){this.options.isDynamic&&this.isSelectFirstItem&&!this.items.$selected&&this.selectFirstItem()}})}(),function(){var n=require("std:log");Vue.component("collection-view",{store:component("std:store"),template:'\n<div>\n\t<slot :ItemsSource="pagedSource" :Pager="thisPager" :Filter="filter">\n\t<\/slot>\n<\/div>\n',props:{ItemsSource:Array,pageSize:Number,initialFilter:Object,initialSort:Object,runAt:String,filterDelegate:Function},data:function(){var n=Object.assign({},{offset:0,dir:"asc",order:""},this.initialFilter);return{filter:this.initialFilter,filteredCount:0,localQuery:n}},watch:{dir:function(){},filter:{handler:function(){this.isServer&&this.filterChanged()},deep:!0}},computed:{isServer:function(){return this.runAt==="serverurl"||this.runAt==="server"},isQueryUrl:function(){return this.runAt==="serverurl"},dir:function(){return this.isQueryUrl?this.$store.getters.query.dir:this.localQuery.dir},offset:function(){return this.isQueryUrl?this.$store.getters.query.offset||0:this.localQuery.offset},order:function(){return this.isQueryUrl?this.$store.getters.query.order:this.localQuery.order},pagedSource:function(){var i=this,r,t;return this.isServer?this.ItemsSource:this.ItemsSource?(r=performance.now(),t=[].concat(this.ItemsSource),this.filterDelegate&&(t=t.filter(function(n){return i.filterDelegate(n,i.filter)})),this.order&&this.dir&&function(){var n=i.order,r=i.dir==="asc";t.sort(function(t,i){return t[n]===i[n]?0:t[n]<i[n]?r?-1:1:r?1:-1})}(),this.filteredCount=t.length,this.pageSize>0&&(t=t.slice(this.offset,this.offset+this.pageSize)),t.$origin=this.ItemsSource,t.indexOf(t.$origin.$selected)==-1&&t.$origin.$clearSelected(),n.time("get paged source:",r),t):null},sourceCount:function(){return this.isServer?this.ItemsSource?this.ItemsSource.$RowCount||0:0:this.ItemsSource.length},thisPager:function(){return this},pages:function(){var n=this.filteredCount;return this.isServer&&(n=this.sourceCount),Math.ceil(n/this.pageSize)}},methods:{$setOffset:function(n){this.runAt==="server"?(this.localQuery.offset=n,this.localQuery.order||(this.localQuery.dir=undefined),this.$root.$emit("localQueryChange",this.localQuery,this.ItemsSource)):this.runAt==="serverurl"?this.$store.commit("setquery",{offset:n}):this.localQuery.offset=n},sortDir:function(n){return n===this.order?this.dir:undefined},doSort:function(n){var t=this.makeNewQuery();t.order===n?t.dir=t.dir==="asc"?"desc":"asc":(t.order=n,t.dir="asc");t.order||(t.dir=null);this.runAt==="server"?(this.copyQueryToLocal(t),this.$root.$emit("localQueryChange",t,this.ItemsSource)):this.runAt==="serverurl"?this.$store.commit("setquery",t):(this.localQuery.dir=t.dir,this.localQuery.order=t.order)},makeNewQuery:function(){var i={dir:this.dir,order:this.order,offset:this.offset},n,t;for(n in this.filter)t=this.filter[n],i[n]=t?t:undefined;return i},copyQueryToLocal:function(n){var t,i;for(t in n)i=n[t],this.localQuery[t]=t==="offset"?n[t]:i?i:undefined},filterChanged:function(){var n=this.makeNewQuery();n.offset=0;n.order||(n.dir=undefined);this.runAt==="server"?(this.copyQueryToLocal(n),this.$root.$emit("localQueryChange",n,this.ItemsSource)):this.runAt==="serverurl"&&this.$store.commit("setquery",n)}},created:function(){var t,n;if(this.initialSort&&(this.localQuery.order=this.initialSort.order,this.localQuery.dir=this.initialSort.dir),this.isQueryUrl){t=this.$store.getters.query;for(n in this.filter)n in t&&(this.filter[n]=t[n])}this.$on("sort",this.doSort)}})}(),function(){var n=require("std:url"),t=require("std:http");Vue.component("a2-upload",{template:'\n            <label :class="cssClass" @dragover="dragOver" @dragleave="dragLeave">\n                <input type="file" @change="uploadImage" v-bind:multiple="isMultiple" accept="image/*" />\n            <\/label>\n        ',props:{item:Object,prop:String,base:String,newItem:Boolean},data:function(){return{hover:!1}},computed:{cssClass:function(){return"file-upload"+(this.hover?" hover":"")},isMultiple:function(){return!!this.newItem}},methods:{dragOver:function(n){this.hover=!0;n.preventDefault()},dragLeave:function(n){this.hover=!1;n.preventDefault()},uploadImage:function(i){var r=this,l=window.$rootUrl,a=this.item[this.prop],v=n.combine(l,"_image",this.base,this.prop,a),o=new FormData,f=!0,s=!1,h=undefined,u,c,e;try{for(u=i.target.files[Symbol.iterator]();!(f=(c=u.next()).done);f=!0)e=c.value,o.append("file",e,e.name)}catch(y){s=!0;h=y}finally{try{!f&&u["return"]&&u["return"]()}finally{if(s)throw h;}}t.upload(v,o).then(function(n){var t,f,e,o;if(i.target.value="",n.status==="OK")if(r.newItem){var c=r.item.$parent,u=!0,s=!1,h=undefined;try{for(t=n.ids[Symbol.iterator]();!(u=(f=t.next()).done);u=!0)e=f.value,o=c.$append(),o[r.prop]=e}catch(l){s=!0;h=l}finally{try{!u&&t["return"]&&t["return"]()}finally{if(s)throw h;}}}else r.item[r.prop]=n.ids[0]})}}})}(),function(){Vue.component("a2-tab-item",{name:"a2-tab-item",template:'\n<div class="tab-item" v-if="isActive">\n    <slot />\n<\/div>\n',props:{header:String,badge:[String,Number,Object],icon:String,tabStyle:String},computed:{hasIcon:function(){return!!this.icon},hasBadge:function(){return!!this.badge},iconCss:function(){return this.icon?"ico ico-"+this.icon:""},isActive:function(){return this===this.$parent.activeTab},tabCssClass:function(){return(this.isActive?"active ":"")+(this.tabStyle||"")}},created:function(){this.$parent.$addTab(this)}});Vue.component("a2-tab-panel",{template:'\n<div class="tab-panel">\n    <template v-if="static">\n        <ul class="tab-header">\n            <li :class="tab.tabCssClass" v-for="(tab, tabIndex) in tabs" :key="tabIndex" @click.prevent="select(tab)">\n                <i v-if="tab.hasIcon" :class="tab.iconCss" ><\/i>\n                <span v-text="tab.header"><\/span><span class="badge" v-if="tab.hasBadge" v-text="tab.badge"><\/span>\t\t\t\t\n            <\/li>\n        <\/ul>\n        <slot name="title" />\n        <div class="tab-content" :class="contentCssClass">\n            <slot />\n        <\/div>\n    <\/template>\n    <template v-else>\n        <ul class="tab-header">\n            <li :class="{active: isActiveTab(item)}" v-for="(item, tabIndex) in items" :key="tabIndex" @click.prevent="select(item)">\n\t\t\t\t<slot name="header" :item="item" :index="tabIndex" :number="tabIndex + 1">\n\t\t\t\t\t<span v-text="defaultTabHeader(item, tabIndex)"><\/span> \n\t\t\t\t<\/slot>\n            <\/li>\n        <\/ul>\n\t\t<slot name="title" />\n        <div class="tab-content">\n            <div class="tab-item" v-if="isActiveTab(item)" v-for="(item, tabIndex) in items" :key="tabIndex">\n                <slot name="items" :item="item" :index="tabIndex" />\n            <\/div>\n        <\/div>\n    <\/template>\n<\/div>\n',props:{items:Array,header:String},data:function(){return{tabs:[],activeTab:null}},computed:{"static":function(){return!this.items},contentCssClass:function(){return this.activeTab?this.activeTab.tabStyle:""}},watch:{items:function(n,t){var i=this.items;n.length<t.length?(this._index>=i.length&&(this._index=i.length-1),this.select(i[this._index])):n.length===t.length?i.length>0&&this.select(i[0]):this.select(i[i.length-1])}},methods:{select:function(n){this.activeTab=n;this.items&&(this._index=this.items.indexOf(n))},isActiveTab:function(n){return n===this.activeTab},defaultTabHeader:function(n,t){return"Tab "+(t+1)},$addTab:function(n){this.tabs.push(n)}},mounted:function(){this.tabs.length>0?this.activeTab=this.tabs[0]:this.items&&this.items.length&&(this.activeTab=this.items[0]);this._index=0}})}(),function(){var n=require("std:utils");Vue.component("a2-list",{template:'<ul class="a2-list" v-lazy="itemsSource">\n    <template v-if="itemsSource">\n\t    <li class="a2-list-item" tabindex="1" :class="cssClass(listItem)" v-for="(listItem, listItemIndex) in itemsSource" :key="listItemIndex" @click.prevent="select(listItem)" @keydown="keyDown">\n            <slot name="items" :item="listItem" />\n\t    <\/li>\n    <\/template>\n    <template v-else>\n        <slot />\n    <\/template>\n<\/ul>\n',props:{itemsSource:Array,autoSelect:String,mark:String,command:Function},computed:{isSelectFirstItem:function(){return this.autoSelect==="first-item"},selectedSource:function(){var n=this.itemsSource;return n?(n.$origin&&(n=n.$origin),n.$selected):null}},methods:{cssClass:function(t){var r=t.$selected?"active":"",i;return this.mark&&(i=n.eval(t,this.mark),i&&(r+=" "+i)),r},select:function(n){n.$select&&n.$select()},selectStatic:function(){alert("yet not implemented");console.dir(this)},selectFirstItem:function(){var n,t;this.isSelectFirstItem&&(n=this.itemsSource,n.length)&&(t=n[0],this.select(t))},keyDown:function(t){var i=this,r=function(n){var t=undefined;(t=i.itemsSource.indexOf(i.selectedSource),t!=-1)&&(t+=n,t!=-1)&&t<i.itemsSource.length&&i.select(i.itemsSource[t])};switch(t.which){case 38:r(-1);break;case 40:r(1);break;case 36:break;case 35:break;case 33:break;case 34:break;case 13:n.isFunction(this.command)&&this.command();break;default:return}t.preventDefault();t.stopPropagation()}},created:function(){this.selectFirstItem()},updated:function(){!this.selectedSource&&this.isSelectFirstItem&&this.selectFirstItem()}})}(),function(){var t=require("std:eventBus"),n=window.$$locale,r={inserted:function(n,t){var i=n.closest(".modal-window");i&&(t.value.width&&(i.style.width=t.value.width),t.value.cssClass&&i.classList.add(t.value.cssClass))}},u={inserted:function(n){function f(n){t.down=!0;t.offset.x=n.pageX;t.offset.y=n.pageY;var f=window.getComputedStyle(i);t.init.x=Number.parseFloat(f.marginLeft);t.init.y=Number.parseFloat(f.marginTop);t.init.cx=Number.parseFloat(f.width);t.init.cy=Number.parseFloat(f.height);document.addEventListener("mouseup",r,!1);document.addEventListener("mousemove",u,!1)}function r(){t.down=!1;document.removeEventListener("mouseup",r);document.removeEventListener("mousemove",u)}function u(n){if(t.down){var e=n.pageX-t.offset.x,o=n.pageY-t.offset.y,r=t.init.x+e,u=t.init.y+o,f=window.innerWidth-t.init.cx,s=window.innerHeight-t.init.cy;u<0&&(u=0);r<0&&(r=0);r>f&&(r=f);i.style.marginLeft=r+"px";i.style.marginTop=u+"px"}}var i=n.closest(".modal-window"),t;i&&(t={down:!1,init:{x:0,y:0,cx:0,cy:0},offset:{x:0,y:0}},n.addEventListener("mousedown",f,!1))}},i;Vue.directive("drag-window",u);Vue.directive("modal-width",r);i={template:'\n<div class="modal-window" @keydown.tab="tabPress">\n    <include v-if="isInclude" class="modal-body" :src="dialog.url"><\/include>\n    <div v-else class="modal-body">\n        <div class="modal-header" v-drag-window><span v-text="title"><\/span><button class="btnclose" @click.prevent="modalClose(false)">&#x2715;<\/button><\/div>\n        <div :class="bodyClass">\n            <i v-if="hasIcon" :class="iconClass" />\n            <div v-text="dialog.message" />\n        <\/div>\n        <div class="modal-footer">\n            <button class="btn btn-default" v-for="(btn, index) in buttons"  :key="index" @click.prevent="modalClose(btn.result)" v-text="btn.text"><\/button>\n        <\/div>\n    <\/div>\n<\/div>        \n',props:{dialog:Object},data:function(){return{keyUpHandler:function(){event.which===27&&(t.$emit("modalClose",!1),event.stopPropagation(),event.preventDefault())}}},methods:{modalClose:function(n){t.$emit("modalClose",n)},tabPress:function(n){function i(){for(var i=document.querySelectorAll(".modal-body [tabindex]"),n=[],t=0;t<i.length;t++)n.push({el:i[t],ti:+i[t].getAttribute("tabindex")});return n=n.sort(function(n,t){return n.ti>t.ti}),console.dir(n),n}if(this._tabElems===undefined&&(this._tabElems=i()),this._tabElems&&this._tabElems.length){var r=this._tabElems[this._tabElems.length-1].ti,u=document.activeElement,t=+u.getAttribute("tabindex");t===r?(n.preventDefault(),this._tabElems[0].el.focus()):t===0&&n.preventDefault()}}},computed:{isInclude:function(){return!!this.dialog.url},hasIcon:function(){return!!this.dialog.style},title:function(){var t=this.dialog.style==="confirm"?n.$Confirm:n.$Error;return this.dialog.title||t},bodyClass:function(){return"modal-body "+(this.dialog.style||"")},iconClass:function(){return"ico ico-"+this.dialog.style},buttons:function(){var t=this.dialog.okText||n.$Ok,i=this.dialog.cancelText||n.$Cancel;return this.dialog.buttons?this.dialog.buttons:this.dialog.style==="alert"?[{text:t,result:!1}]:[{text:t,result:!0},{text:i,result:!1}]}},created:function(){document.addEventListener("keyup",this.keyUpHandler)},mounted:function(){},destroyed:function(){document.removeEventListener("keyup",this.keyUpHandler)}};app.components["std:modal"]=i}(),function(){var n=require("std:url");Vue.component("a2-image",{template:'\n<div>\n    <span v-text="href"><\/span>\n    <span>{{newElem}}<\/span>\n    <img v-if="isImageVisible" :src="href" style="width:auto;height:auto;max-width:300px" @click.prevent="clickOnImage"/>\n    <a @click.prevent="removeImage">x<\/a>\n    <a2-upload v-if="isUploadVisible" :item="itemForUpload" :base="base" :prop="prop" :new-item="newItem"/>\n<\/div>\n',props:{base:String,item:Object,prop:String,newItem:Boolean,inArray:Boolean,source:Array},data:function(){return{newElem:{}}},computed:{href:function(){if(this.newItem)return undefined;var t=window.$rootUrl,i=this.item[this.prop];return n.combine(t,"_image",this.base,this.prop,i)},isImageVisible:function(){return!this.newItem},isUploadVisible:function(){return this.newItem?!0:!this.inArray&&!this.item[this.prop]},itemForUpload:function(){return this.newItem?this.newElem:this.item}},methods:{removeImage:function(){this.inArray?this.item.$remove():this.item[this.prop]=undefined},clickOnImage:function(){alert("click on image")}},created:function(){this.newItem&&this.source&&this.source.$new&&(this.newElem=this.source.$new())}})}();Vue.component("a2-taskpad",{template:'<div :class="cssClass">\n\t<a class="ico taskpad-collapse-handle" @click.stop="toggle"><\/a>\n\t<div v-if="expanded" class="taskpad-body">\n\t\t<slot>\n\t\t<\/slot>\n\t<\/div>\n\t<div v-else class="taskpad-title" @click.prevent="toggle">\n\t\t<span class="taskpad-label">Задачи<\/span>\n\t<\/div>\n<\/div>\n',data:function(){return{expanded:!0,__savedCols:""}},computed:{cssClass:function(){return"taskpad"+(this.expanded?" expanded":" collapsed")}},methods:{toggle:function(){var n=this.$el.parentElement.style;this.expanded=!this.expanded;n.gridTemplateColumns=this.expanded?this.__savedCols:"1fr 20px"}},mounted:function(){var n=this.$el.parentElement.style;this.__savedCols=n.gridTemplateColumns}});Vue.component("a2-panel",{template:'<div :class="cssClass">\n    <div class="panel-header" @click.prevent="toggle" v-if="!noHeader">\n        <slot name=\'header\'><\/slot>\n\t    <span v-if="collapsible" class="ico panel-collapse-handle"><\/span>\n    <\/div>\n    <slot v-if="expanded"><\/slot>\n<\/div>\n',props:{initialCollapsed:Boolean,collapsible:Boolean,panelStyle:String,noHeader:Boolean},data:function(){return{collapsed:this.initialCollapsed}},computed:{cssClass:function(){var n="panel";if(n+=this.collapsed?" collapsed":" expanded",this.panelStyle)switch(this.panelStyle.toLowerCase()){case"red":case"danger":case"error":n+=" panel-red";break;case"info":case"cyan":n+=" panel-cyan";break;case"green":case"success":n+=" panel-green";break;case"warning":case"yellow":n+=" panel-yellow"}return n},expanded:function(){return!this.collapsed}},methods:{toggle:function(){this.collapsible&&(this.collapsed=!this.collapsed)}}}),function(){function n(i,r,u){var o,e,f;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(r in i)){t.next=14;break}o=i[r];e=0;case 3:if(!(e<o.length)){t.next=13;break}return f=o[e],f.$level=u,t.next=8,f;case 8:if(f.$collapsed){t.next=10;break}return t.delegateYield(n(f,r,u+1),"t0",10);case 10:e++;t.next=3;break;case 13:case 14:case"end":return t.stop()}},t[0],this)}var t=[n].map(regeneratorRuntime.mark);Vue.component("a2-sheet",{template:'\n<table class="sheet">\n    <thead>\n        <slot name="header"><\/slot>\n    <\/thead>\n    <slot name="body"><\/slot>\n    <tfoot>\n        <slot name="footer"><\/slot>\n    <\/tfoot>    \n<\/table>\n'});Vue.component("a2-sheet-section",{template:"\n<tbody>\n    <slot><\/slot>\n<\/tbody>\n"});Vue.component("a2-sheet-section-tree",{functional:!0,name:"a2-sheet-section",props:{itemsSource:Object,propName:String},render:function(t,i){function v(){var n=this.item.$collapsed||!1;Vue.set(this.item,"$collapsed",!n)}function y(){var n="";return this.hasChildren()&&(n+="has-children"),this.item.$collapsed&&(n+=" collapsed"),n+(" lev-"+this.item.$level)}function p(){var n="";return this.hasChildren()&&(n+=" group"),this.item.$collapsed&&(n+=" collapsed"),n}function w(){return"indent lev-"+this.item.$level}function b(){var n=this.item[f];return n&&n.length>0}var f=i.props.propName,o=i.props.itemsSource,r,s,h,u;if(o&&f){var k=i.data.scopedSlots["default"],c=[],e=!0,l=!1,a=undefined;try{for(r=n(o,f,1)[Symbol.iterator]();!(e=(s=r.next()).done);e=!0)h=s.value,u=k({item:h,toggle:v,cssClass:y,hasChildren:b,rowCssClass:p,indentCssClass:w})[0],c.push(t(u.tag,u.data,u.children))}catch(d){l=!0;a=d}finally{try{!e&&r["return"]&&r["return"]()}finally{if(l)throw a;}}return t("tbody",{},c)}}})}(),function(){Vue.component("a2-graphics",{template:'<div :id="id" class="a2-graphics"><\/div>',props:{id:String,render:Function},computed:{controller:function(){return this.$root}},methods:{},mounted:function(){var n=d3.select("#"+this.id);this.render.call(this.controller.$data,n)}})}(),function(){function t(n){return JSON.stringify(n,function(n,t){return n[0]==="$"?n in f?undefined:t:n[0]==="_"?undefined:t},2)}var i=require("std:dataservice"),r=require("std:url"),u=require("std:eventBus"),n=window.$$locale,f={$vm:null,$host:null,$root:null,$parent:null},e={name:"a2-trace-item",template:'\n<div v-if="hasElem" class="trace-item-body">\n    <span class="title" v-text="name"/><span class="badge" v-text="elem.length"/>\n    <ul class="a2-debug-trace-item">\n        <li v-for="itm in elem">\n            \n            <div class="rq-title"><span class="elapsed" v-text="itm.elapsed + \' ms\'"/> <span v-text="itm.text"/><\/div>\n        <\/li>\n    <\/ul>\n<\/div>\n',props:{name:String,elem:Array},computed:{hasElem:function(){return this.elem&&this.elem.length}}};Vue.component("a2-debug",{template:'\n<div class="debug-panel" v-if="paneVisible">\n    <div class="debug-pane-header">\n        <span class="debug-pane-title" v-text="title"><\/span>\n        <a class="btn btn-close" @click.prevent="close">&#x2715<\/a>\n    <\/div>\n    <div class="toolbar">\n        <button class="btn btn-tb" @click.prevent="refresh"><i class="ico ico-reload"><\/i> {{text(\'$Refresh\')}}<\/button>\n    <\/div>\n    <div class="debug-model debug-body" v-if="modelVisible">\n        <pre class="a2-code" v-text="modelJson()"><\/pre>\n    <\/div>\n    <div class="debug-trace debug-body" v-if="traceVisible">\n        <ul class="a2-debug-trace">\n            <li v-for="r in trace">\n                <div class="rq-title"><span class="elapsed" v-text="r.elapsed + \' ms\'"/> <span v-text="r.url" /><\/div>\n                <a2-trace-item name="Sql" :elem="r.items.Sql"><\/a2-trace-item>\n                <a2-trace-item name="Render" :elem="r.items.Render"><\/a2-trace-item>\n                <a2-trace-item name="Workflow" :elem="r.items.Workflow"><\/a2-trace-item>\n                <a2-trace-item class="exception" name="Exceptions" :elem="r.items.Exception"><\/a2-trace-item>\n            <\/li>\n        <\/ul>\n    <\/div>\n<\/div>\n',components:{"a2-trace-item":e},props:{modelVisible:Boolean,traceVisible:Boolean,modelStack:Array,counter:Number,close:Function},data:function(){return{trace:[]}},computed:{refreshCount:function(){return this.counter},paneVisible:function(){return this.modelVisible||this.traceVisible},title:function(){return this.modelVisible?n.$DataModel:this.traceVisible?n.$Profiling:""},traceView:function(){return this.traceVisible}},methods:{modelJson:function(){if(this.modelVisible)return this.modelStack.length?t(this.modelStack[0].$data):""},refresh:function(){this.modelVisible?this.$forceUpdate():this.traceVisible&&this.loadTrace()},loadTrace:function(){var t=window.$$rootUrl,u=r.combine(t,"shell/trace"),n=this;i.post(u).then(function(t){(n.trace.splice(0,n.trace.length),t)&&t.forEach(function(t){n.trace.push(t)})})},text:function(t){return n[t]}},watch:{refreshCount:function(){this.$forceUpdate()},traceView:function(n){n&&this.loadTrace()}},created:function(){var n=this;u.$on("endRequest",function(t){t.indexOf("/shell/trace")==-1&&n.traceVisible&&n.loadTrace()})}})}(),function(){var n={render:function(){return null},props:["page-title"],watch:{pageTitle:function(){this.setTitle()}},methods:{setTitle:function(){this.pageTitle&&(document.title=this.pageTitle)}},created:function(){this.setTitle()}};app.components["std:doctitle"]=n}();Vue.directive("autoSize",{bind:function(n,t){function i(){n._autosize()}t.value&&(n.style.overflowY=!1,n._ops={initHeight:-1,extraSpace:0},n._autosize=function(){var t,i;n.offsetHeight&&(t=n._ops,t.initHeight===-1&&(t.initHeight=n.offsetHeight),n.style.height=t.initHeight+"px",i=n.scrollHeight+t.extraSpace,i>t.initHeight&&(n.style.height=i+"px"))},n.addEventListener("input",i))},inserted:function(n,t){if(t.value){var i=window.getComputedStyle(n),r=parseFloat(i.borderTopWidth)+parseFloat(i.borderBottomWidth);n._ops.extraSpace=r;setTimeout(function(){return n._autosize()},1)}}});Vue.directive("disable",{bind:function(n){function t(n){if(this.getAttribute("disabled"))return n.preventDefault(),n.stopImmediatePropagation(),!1}n.addEventListener("click",t,!0)}});Vue.directive("dropdown",{bind:function(n){var t=require("std:popup"),i=this;n._btn=n.querySelector("[toggle]");n.setAttribute("dropdown-top","");n._btn||console.error("DropDown does not have a toggle element");t.registerPopup(n);n._close=function(){n._hide&&n._hide();n.classList.remove("show")};n.addEventListener("click",function(i){for(var r=i.target,f,u;r;){if(r===n._btn)break;if(r===n)return;r=r.parentElement}r===n._btn&&(i.preventDefault(),i.stopPropagation(),f=n.classList.contains("show"),f?(n._hide&&n._hide(),n.classList.remove("show")):(u=t.closest(n,".popup-body"),u?t.closeInside(u):t.closeAll(),n._show&&n._show(),n.classList.add("show")))})},unbind:function(n){var t=require("std:popup");t.unregisterPopup(n)}});Vue.directive("focus",{bind:function(n){function t(n){var t=n.target;t._selectDone||(t._selectDone=!0,t.select&&t.select())}n.addEventListener("focus",function(n){n.target.parentElement.classList.add("focus");setTimeout(function(){t(n)},0)},!1);n.addEventListener("blur",function(n){var t=n.target;t._selectDone=!1;n.target.parentElement.classList.remove("focus")},!1);n.addEventListener("click",function(n){t(n)},!1)},inserted:function(n){n.tabIndex===1&&setTimeout(function(){n.focus&&n.focus();n.select&&n.select()},0)}});Vue.directive("settabindex",{inserted:function(n){n.tabIndex===1&&setTimeout(function(){n.focus&&n.focus()},0)}}),function(){function n(n){n&&n.$loadLazy&&n.$loadLazy()}Vue.directive("lazy",{componentUpdated:function(t,i){n(i.value)},inserted:function(t,i){n(i.value)}})}(),function(){Vue.directive("mask",{componentUpdated:function(){},inserted:function(){}})}();Vue.directive("resize",{bind:function(n){Vue.nextTick(function(){function h(n){var r=!0,u=!1,f=undefined,t,e,i;try{for(t=n.childNodes[Symbol.iterator]();!(r=(e=t.next()).done);r=!0)if(i=e.value,i.nodeType===Node.ELEMENT_NODE&&i.classList.contains("drag-handle"))return i}catch(o){u=!0;f=o}finally{try{!r&&t["return"]&&t["return"]()}finally{if(u)throw f;}}return null}function f(i){var r=n._parts,u;r.resizing&&(i.preventDefault(),r.handle.style.display="none",r.grid.style.cursor="default",u=r.offsetX(i),u=r.fitX(u),r.grid.style.gridTemplateColumns=u+"px "+t+"px 1fr",document.removeEventListener("mouseup",f),document.removeEventListener("mousemove",e),r.resizing=!1)}function e(t){var i=n._parts,r;i.resizing&&(t.preventDefault(),r=i.offsetX(t),r=i.fitX(r),i.handle.style.left=r+"px")}var o=20,t=6,s=n.parentElement,i=Number.parseFloat(n.getAttribute("data-min-width")),r=Number.parseFloat(n.getAttribute("second-min-width")),u;if(isNaN(i)&&(i=o),isNaN(r)&&(r=o),u={grid:s,handle:h(s),resizing:!1,minWidth:i,minWidth2:r,offsetX:function(n){var t=this.grid.getBoundingClientRect();return n.clientX-t.left},fitX:function(n){n<this.minWidth&&(n=this.minWidth);var i=this.grid.clientWidth;return n+t+this.minWidth2>i&&(n=i-this.minWidth2-t),n}},!u.handle){console.error("Resize handle not found");return}n._parts=u;n.addEventListener("mousedown",function(t){var i=n._parts,r;i.resizing||(t.preventDefault(),r=i.offsetX(t),i.handle.style.left=r+"px",i.handle.style.display="block",i.grid.style.cursor="w-resize",document.addEventListener("mouseup",f,!1),document.addEventListener("mousemove",e,!1),i.resizing=!0)},!1)})}}),function(){function f(n,i,r,u){return new Promise(function(f){var e={promise:null,data:i,query:r};t.$emit("modal",n,e);e.promise.then(function(n){u(n);f(n)})})}var t=require("std:eventBus"),n=require("std:utils"),u=require("std:dataservice"),i=require("std:url"),e=require("std:log"),r=window.$$locale,h=component("std:store"),c=component("std:doctitle"),o=0,s=0,l=Vue.extend({store:h,components:{"a2-document-title":c},data:function(){return{__init__:!0,__baseUrl__:"",__baseQuery__:{},__requestsCount__:0}},computed:{$baseUrl:function(){return this.$data.__baseUrl__},$baseQuery:function(){return this.$data.__baseQuery__},$indirectUrl:function(){return this.$data.__modelInfo.__indirectUrl__||""},$query:function(){return this.$data._query_},$isDirty:function(){return this.$data.$dirty},$isPristine:function(){return!this.$data.$dirty},$isLoading:function(){return this.$data.__requestsCount__>0},$modelInfo:function(){return this.$data.__modelInfo},$canSave:function(){return this.$isDirty&&!this.$isLoading}},methods:{$marker:function(){return!0},$exec:function(n,t,i,r){if(!this.$isReadOnly(r)){var u=this.$data;u._exec_(n,t,i,r);return}},$isReadOnly:function(n){return n&&n.checkReadOnly&&this.$data.$readOnly},$execSelected:function(t,i,r){var u=this.$data;if(!n.isArray(i)){console.error("Invalid argument for $execSelected");return}r?this.$confirm(r).then(function(){return u._exec_(t,i.$selected)}):u._exec_(t,i.$selected)},$canExecute:function(n,t,i){if(this.$isReadOnly(i))return!1;var r=this.$data;return r._canExec_(n,t,i)},$save:function(){if(!this.$data.$readOnly){var t=this,i=window.$$rootUrl,r=i+"/_data/save",f=this.$indirectUrl||this.$baseUrl;return new Promise(function(i){var e=n.toJson({baseUrl:f,data:t.$data}),o=t.$baseUrl.endsWith("/new");u.post(r,e).then(function(n){var u,r,f;t.$data.$merge(n);t.$data.$setDirty(!1);u=undefined;r=undefined;for(f in n)if(u=n[f],r=t.$data[f].$id,u)break;o&&r&&(t.$store.commit("setnewid",{id:r}),t.$data.__baseUrl__=t.$data.__baseUrl__.replace("/new","/"+r));i(u)})["catch"](function(n){t.$alertUi(n)})})}},$invoke:function(t,r,f){var e=this,s=window.$$rootUrl,h=s+"/_data/invoke",o=e.$indirectUrl||e.$baseUrl;return f&&(o=i.combine("_page",f,"index",0)),new Promise(function(i){var f=n.toJson({cmd:t,baseUrl:o,data:r});u.post(h,f).then(function(t){if(n.isObject(t))i(t);else throw new Error("Invalid response type for $invoke");})["catch"](function(n){e.$alertUi(n)})})},$asyncValid:function(n,t){var r=this,u=r.__asyncCache__,f=JSON.stringify(t),i=u[n];return(i||(i={data:"",result:null},u[n]=i),i.data===f)?i.result:(i.data=f,new Promise(function(u){Vue.nextTick(function(){r.$invoke(n,t).then(function(n){i.result=n.Result.Value;u(i.result)})})}))},$reload:function(t){var r=this,e,o;if(n.isArray(t))return e=t._path_.lastIndexOf("."),o=t._path_.substring(e+1),t.$loaded=!1,r.$loadLazy(t.$parent,o);var s=window.$$rootUrl,h=s+"/_data/reload",f=r.$data;return new Promise(function(){var t={baseUrl:r.$baseUrl},e,o;n.isDefined(f.Query)&&(t.baseUrl=i.replaceUrlQuery(r.$baseUrl,f.Query),e=i.replaceUrlQuery(null,f.Query),window.history.replaceState(null,null,e));o=n.toJson(t);u.post(h,o).then(function(t){if(n.isObject(t))f.$merge(t),f._fireLoad_();else throw new Error("Invalid response type for $reload");})["catch"](function(n){r.$alertUi(n)})})},$requery:function(){this.inDialog?alert("$requery command is not supported in dialogs"):t.$emit("requery")},$remove:function(n,t){this.$data.$readOnly||(t?this.$confirm(t).then(function(){return n.$remove()}):n.$remove())},$removeSelected:function(t,i){if(n.isArray(t)||console.error("$removeSelected. The argument is not an array"),!this.$data.$readOnly){var r=t.$selected;r&&this.$remove(r,i)}},$href:function(t,r){var u=r;return n.isObjectExact(u)&&(u=u.$id),i.combine(t,u)},$navigate:function(n,t,r){var u=i.createUrlForNavigate(n,t);r===!0?window.open(u,"_blank"):this.$store.commit("navigate",{url:u})},$replaceId:function(n){this.$store.commit("setnewid",{id:n});this.$data.__baseUrl__=self.$data.__baseUrl__.replace("/new","/"+n)},$dbRemove:function(t,i){function r(){var i=o+"/_data/dbRemove",r=n.toJson({baseUrl:f.$baseUrl,id:e});u.post(i,r).then(function(){t.$remove()})["catch"](function(n){f.$alertUi(n)})}if(t){var e=t.$id,o=window.$$rootUrl,f=this;i?this.$confirm(i).then(function(){r()}):r()}},$dbRemoveSelected:function(n,t){var i=n.$selected;i&&this.$dbRemove(i,t)},$openSelected:function(t,i){var r,u;if(t=t||"",r=i.$selected,r){if(t.startsWith("{")){if(t=t.substring(1,t.length-1),u=n.eval(r,t),!u)throw new Error("Property '"+t+"' not found in "+r.constructor.name+" object");t=u}this.$navigate(t,r.$id)}},$hasSelected:function(n){return n&&!!n.$selected},$hasChecked:function(n){return n&&n.$checked&&n.$checked.length},$confirm:function(i){n.isString(i)&&(i={message:i});i.style="confirm";i.message=i.message||i.msg;var r={promise:null,data:i};return t.$emit("confirm",r),r.promise},$alert:function(n,i){var r={promise:null,data:{message:n,title:i,style:"alert"}};return t.$emit("confirm",r),r.promise},$alertUi:function(n){if(n instanceof Error){alert(n.message);return}n.indexOf("UI:")===0?this.$alert(n.substring(3).replace("\\n","\n")):alert(n)},$showDialog:function(n,t,i,r){return this.$dialog("show",n,t,i,r)},$dialog:function(t,i,u,e,o){function s(){if(!n.isArray(u))return console.error("$dialog."+t+". The argument is not an array"),!0}function l(){if(!n.isObjectExact(u))return console.error("$dialog."+t+". The argument is not an object"),!0}function h(){switch(t){case"append":return s()?void 0:f(i,0,e,function(n){u.$append(n)});case"browse":if(!n.isObject(u)){console.error("$dialog."+t+". The argument is not an object");return}return f(i,u,e,function(n){u.$merge(n,!0)});case"edit-selected":return s()?void 0:f(i,u.$selected,e,function(n){u.$selected.$merge(n,!1)});case"edit":return l()?void 0:f(i,u,e,function(n){u.$merge(n,!1)});default:return f(i,u,e,function(){})}}if(!this.$isReadOnly(o)){if(o&&o.validRequired&&root.$invalid){this.$alert(r.$MakeValidFirst);return}if(o&&o.saveRequired&&this.$isDirty){var c=null;return this.$save().then(function(){c=h()}),c}return h()}},$report:function(t,u,f){var e=this;if(!this.$isReadOnly(f)){if(doReport=function(){var f=u;u&&n.isObject(u)&&(f=u.$id);var o=window.$$rootUrl,r=o+"/report/show/"+f,s=e.$indirectUrl||e.$baseUrl,h=i.makeBaseUrl(s);r=r+i.makeQueryString({base:h,rep:t});window.open(r,"_blank")},f&&f.validRequired&&root.$invalid){this.$alert(r.$MakeValidFirst);return}f&&f.saveRequired&&this.$isDirty?this.$save().then(function(){return doReport()}):doReport()}},$modalSaveAndClose:function(n,i){if(this.$isDirty){var u=this.$data;if(i&&i.validRequired&&u.$invalid){this.$alert(r.$MakeValidFirst);return}this.$save().then(function(n){return t.$emit("modalClose",n)})}else t.$emit("modalClose",n)},$modalClose:function(n){t.$emit("modalClose",n)},$modalSelect:function(n){if(!("$selected"in n)){console.error("invalid array for $modalSelect");return}this.$modalClose(n.$selected)},$modalSelectChecked:function(n){if(!("$checked"in n)){console.error("invalid array for $modalSelectChecked");return}var t=n.$checked;t.length>0&&this.$modalClose(t)},$saveAndClose:function(){var n=this;this.$isDirty?this.$save().then(function(){return n.$close()}):this.$close()},$close:function(){this.$saveModified()&&this.$store.commit("close")},$showHelp:function(n){window.open(this.$helpHref(n),"_blank")},$helpHref:function(n){var t=document.querySelector("meta[name=helpUrl]");return t&&t.content||console.error("help url is not specified"),t.content+n},$searchChange:function(){var n=this.$store.replaceUrlSearch(this.$baseUrl);this.$data.__baseUrl__=n;this.$reload()},$saveModified:function(){if(!this.$isDirty)return!0;var n=this,t={message:r.$ElementWasChanged,title:r.$ConfirmClose,buttons:[{text:r.$Save,result:"save"},{text:r.$NotSave,result:"close"},{text:r.$Cancel,result:!1}]};return this.$confirm(t).then(function(t){t==="close"?(n.$data.$setDirty(!1),n.$close()):t==="save"&&n.$save().then(function(){n.$close()})}),!1},$format:function(t,i,r,u){return!r&&!i?t:(i&&(t=n.format(t,i,u&&u.hideZeros)),r&&r.indexOf("{0}")!==-1)?r.replace("{0}",t):t},$expand:function(t,i){var r=t[i];if(!r.$loaded&&n.isDefined(t.$hasChildren)){var f=this,e=window.$$rootUrl,o=e+"/_data/expand",s=n.toJson({baseUrl:f.$baseUrl,id:t.$id});u.post(o,s).then(function(n){var h=n[i],t,f,e;r.$empty();var u=!0,o=!1,s=undefined;try{for(t=h[Symbol.iterator]();!(u=(f=t.next()).done);u=!0)e=f.value,r.push(r.$new(e))}catch(c){o=!0;s=c}finally{try{!u&&t["return"]&&t["return"]()}finally{if(o)throw s;}}})["catch"](function(n){f.$alertUi(n)});r.$loaded=!0}},$loadLazy:function(t,i){var r=this,f=window.$$rootUrl,e=f+"/_data/loadlazy",o=n.toJson({baseUrl:r.$baseUrl,id:t.$id,prop:i});return new Promise(function(n){var f=t[i];if(f.$loaded){n(f);return}u.post(e,o).then(function(t){var r,o,s,u;if(i in t){f.$empty();var e=!0,h=!1,c=undefined;try{for(r=t[i][Symbol.iterator]();!(e=(o=r.next()).done);e=!0)s=o.value,f.push(f.$new(s))}catch(l){h=!0;c=l}finally{try{!e&&r["return"]&&r["return"]()}finally{if(h)throw c;}}u=i+".$RowCount";u in t&&(f.$RowCount=t[u])}n(f)})["catch"](function(n){r.$alertUi(n)});f.$loaded=!0})},$delegate:function(n){var t=this.$data;return t._delegate_(n)},__beginRequest:function(){this.$data.__requestsCount__+=1},__endRequest:function(){this.$data.__requestsCount__-=1},__queryChange:function(t,r){var f,u;n.isObjectExact(t)||console.error("base.__queryChange. invalid argument type");f=Object.assign({},this.$baseQuery);for(u in t)t[u]?f[u]=t[u]:delete f[u];this.$data.__baseUrl__=this.$store.replaceUrlSearch(this.$baseUrl,i.makeQueryString(f));this.$reload(r)},__doInit__:function(){var t=this.$data,n;t._modelLoad_&&(n=null,this.$caller&&(n=this.$caller.$data),t._modelLoad_(n))}},created:function(){var n={caller:null};t.$emit("registerData",this,n);this.$caller=n.caller;t.$on("beginRequest",this.__beginRequest);t.$on("endRequest",this.__endRequest);t.$on("queryChange",this.__queryChange);this.$on("localQueryChange",this.__queryChange);this.__asyncCache__={};e.time("create time:",s,!1)},beforeDestroy:function(){},destroyed:function(){t.$emit("registerData",null);t.$off("beginRequest",this.__beginRequest);t.$off("endRequest",this.__endRequest);t.$off("queryChange",this.__queryChange);this.$off("localQueryChange",this.__queryChange)},beforeUpdate:function(){o=performance.now()},beforeCreate:function(){s=performance.now()},updated:function(){e.time("update time:",o,!1)}});app.components.baseController=l}(),function(){function r(n,t,i){var f,u,e;if(!n)return null;for(f=0;f<n.length;f++){if(u=n[f],t(u))return u;if(u.Menu&&(i&&(i.Url=u.Url),e=r(u.Menu,t),e))return e}return null}function u(n,i,u){var e,c,o,f,h,s;if((u=u||{},i=t.combine(i),e=i.split("/"),e.length===5||e.length===4)||(c=e.length,o=e[1],o==="app"))return i;if(f=null,o&&(f=n.find(function(n){return n.Url===o})),f){if(f&&!f.Menu)return u.title=f.Name,i}else if(h={Url:""},f=r(n,function(n){return n.Url&&!n.Menu},h),f)return u.title=f.Name,t.combine(i,h.Url,f.Url);return(i=t.combine(o),s=e[2],!s&&u.seg2&&(s=u.seg2),f=s?r(f.Menu,function(n){return n.Url===s}):r(f.Menu,function(n){return n.Url&&!n.Menu}),f)?(u.title=f.Name,t.combine(i,f.Url)):i}var i=component("std:store"),n=require("std:eventBus"),s=component("std:modal"),e=require("std:popup"),t=require("std:url"),o=require("std:log"),h=require("std:utils"),f="unknown title",c={template:'\n<ul class="nav-bar">\n    <li v-for="(item, index) in menu" :key="index" :class="{active : isActive(item)}">\n        <a :href="itemHref(item)" tabindex="-1" v-text="item.Name" @click.prevent="navigate(item)"><\/a>\n    <\/li>\n<\/ul>\n',props:{menu:Array},computed:{seg0:function(){return i.getters.seg0}},methods:{isActive:function(n){return this.seg0===n.Url},itemHref:function(n){return"/"+n.Url},navigate:function(n){var e,i,f,o;this.isActive(n)||(e="menu:"+t.combine(window.$$rootUrl,n.Url),i=localStorage.getItem(e)||"",i&&!r(n.Menu,function(n){return n.Url===i})&&(i=""),f={title:null,seg2:i},o=u(this.menu,n.Url,f),this.$store.commit("navigate",{url:o,title:f.title}))}}},l={template:'\n<div :class="cssClass">\n    <a href role="button" class="ico collapse-handle" @click.prevent="toggle"><\/a>\n    <div class="side-bar-body" v-if="bodyIsVisible">\n        <tree-view :items="sideMenu" :is-active="isActive" :click="navigate" :get-href="itemHref"\n            :options="{folderSelect: folderSelect, label: \'Name\', title: \'Description\',\n                subitems: \'Menu\',\n                icon:\'Icon\', wrapLabel: true, hasIcon: true}">\n        <\/tree-view>\n    <\/div>\n    <div v-else class="side-bar-title" @click.prevent="toggle">\n        <span class="side-bar-label" v-text="title"><\/span>\n    <\/div>\n<\/div>\n',props:{menu:Array},computed:{seg0:function(){return i.getters.seg0},seg1:function(){return i.getters.seg1},cssClass:function(){return"side-bar "+(this.$parent.sideBarCollapsed?"collapsed":"expanded")},bodyIsVisible:function(){return!this.$parent.sideBarCollapsed},title:function(){var t=this.sideMenu,i,n;return t?(i=this.seg1,n=r(t,function(n){return n.Url===i}),n)?n.Name||f:f:f},sideMenu:function(){var n=this.topMenu;return n?n.Menu:null},topMenu:function(){var n=this.seg0;return r(this.menu,function(t){return t.Url===n})}},methods:{isActive:function(n){return this.seg1===n.Url},folderSelect:function(n){return!!n.Url},navigate:function(n){var i,r;if(!this.isActive(n))if(i=this.topMenu,i){if(r=t.combine(i.Url,n.Url),n.Url.indexOf("/")===-1)try{localStorage.setItem("menu:"+t.combine(window.$$rootUrl,i.Url),n.Url)}catch(u){}this.$store.commit("navigate",{url:r,title:n.Name})}else console.error("no top menu found")},itemHref:function(n){var i=this.topMenu;return i?t.combine(i.Url,n.Url):undefined},toggle:function(){this.$parent.sideBarCollapsed=!this.$parent.sideBarCollapsed}}},a={render:function(n){return n("div",{attrs:{"class":"content-view "+this.cssClass}},[n("include",{props:{src:this.currentView,needReload:this.needReload}})])},computed:{currentView:function(){var u=window.$$rootUrl,n=i.getters.url,r=i.getters.len;return(r===2||r===3)&&(n+="/index/0"),t.combine(u,"/_page",n)+i.getters.search},cssClass:function(){var n=this.$store.getters.route;return n.seg0==="app"?"full-view":n.len===3?"partial-page":n.len===2?"full-page":"full-view"}},data:function(){return{needReload:!1}},created:function(){var t=this;n.$on("requery",function(){t.needReload=!0;Vue.nextTick(function(){return t.needReload=!1})})}},v={store:i,template:'\n<div :class="cssClass">\n    <a2-nav-bar :menu="menu" v-show="navBarVisible"><\/a2-nav-bar>\n    <a2-side-bar :menu="menu" v-show="sideBarVisible"><\/a2-side-bar>\n    <a2-content-view><\/a2-content-view>\n    <div class="load-indicator" v-show="pendingRequest"><\/div>\n    <div class="modal-stack" v-if="hasModals">\n        <div class="modal-wrapper" v-for="dlg in modals">\n            <a2-modal :dialog="dlg"><\/a2-modal>\n        <\/div>\n    <\/div>\n<\/div>',components:{"a2-nav-bar":c,"a2-side-bar":l,"a2-content-view":a,"a2-modal":s},props:{menu:Array},data:function(){return{sideBarCollapsed:!1,requestsCount:0,modals:[]}},computed:{route:function(){return this.$store.getters.route},navBarVisible:function(){var n=this.route;return n.seg0!=="app"&&(n.len===2||n.len===3)},sideBarVisible:function(){var n=this.route;return n.seg0!=="app"&&n.len===3},cssClass:function(){return"main-view "+(this.sideBarCollapsed?"side-bar-collapsed":"side-bar-expanded")},pendingRequest:function(){return this.requestsCount>0},hasModals:function(){return this.modals.length>0}},created:function(){var f,e,o,r;if(!this.menu){alert("access denied");return}f={title:null};e=u(this.menu,t.normalizeRoot(window.location.pathname),f);e=e+window.location.search;this.$store.commit("setstate",{url:e,title:f.title});o={url:"",title:""};o.url=u(this.menu,"/",f);o.title=f.title;t.firstUrl=o;r=this;n.$on("beginRequest",function(){r.hasModals||(r.requestsCount+=1)});n.$on("endRequest",function(){r.hasModals||(r.requestsCount-=1)});n.$on("modal",function(n,u){var o=h.getStringId(u?u.data:null),s=window.$$rootUrl,e=t.combine(s,"/_dialog",n,o),f;e=i.replaceUrlQuery(e,u.query);f={title:"dialog",url:e,prms:u.data};f.promise=new Promise(function(n){f.resolve=n});u.promise=f.promise;r.modals.push(f)});n.$on("modalClose",function(n){var t=r.modals.pop();n&&t.resolve(n)});n.$on("modalCloseAll",function(){while(r.modals.length){var n=r.modals.pop();n.resolve(!1)}});n.$on("confirm",function(n){var t=n.data;t.promise=new Promise(function(n){t.resolve=n});n.promise=t.promise;r.modals.push(t)})}},y=Vue.extend({components:{"a2-main-view":v},store:i,data:function(){return{requestsCount:0,debugShowTrace:!1,debugShowModel:!1,dataCounter:0}},computed:{processing:function(){return this.requestsCount>0},traceEnabled:{get:function(){return o.traceEnabled()},set:function(n){o.enableTrace(n)}},modelStack:function(){return this.__dataStack__}},methods:{about:function(){this.$store.commit("navigate",{url:"/app/about"})},root:function(){var n={title:null},t=this.$store.getters.url,i=u(this.menu,"/",n);t!==i&&this.$store.commit("navigate",{url:u(this.menu,"/",n),title:n.title})},debugOptions:function(){alert("debug options")},debugTrace:function(){this.debugShowModel=!1;this.debugShowTrace=!this.debugShowTrace},debugModel:function(){this.debugShowTrace=!1;this.debugShowModel=!this.debugShowModel},debugClose:function(){this.debugShowModel=!1;this.debugShowTrace=!1},profile:function(){alert("user profile")},changeUser:function(){alert("change user")},changePassword:function(){alert("change password");var t={promise:null,data:{Id:-1}};n.$emit("modal","/app/changePassword",t);t.promise.then(function(n){n===!1})}},created:function(){var t=this;t.__dataStack__=[];window.addEventListener("popstate",function(i){if(n.$emit("modalCloseAll"),t.__dataStack__.length>0){var u=t.__dataStack__[0],r=i.state;if(!u.$saveModified()){r=u.$data.__baseUrl__.replace("/_page","");window.history.pushState(r,null,r);return}}t.$store.commit("popstate")});n.$on("registerData",function(n,i){t.dataCounter+=1;n?(t.__dataStack__.length>0&&(i.caller=t.__dataStack__[0]),t.__dataStack__.unshift(n)):t.__dataStack__.shift(n)});e.startService();n.$on("beginRequest",function(){return t.requestsCount+=1});n.$on("endRequest",function(){return t.requestsCount-=1});n.$on("closeAllPopups",e.closeAll)}});app.components["std:shellController"]=y}();